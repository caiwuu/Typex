(()=>{var t={888:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",o=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),o&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),o&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,o,r,i){"string"==typeof t&&(t=[[null,t,void 0]]);var s={};if(o)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(s[l]=!0)}for(var c=0;c<t.length;c++){var d=[].concat(t[c]);o&&s[d[0]]||(void 0!==i&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=i),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),r&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=r):d[4]="".concat(r)),e.push(d))}},e}},864:t=>{"use strict";t.exports=function(t,e){return e||(e={}),t?(t=String(t.__esModule?t.default:t),/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),e.hash&&(t+=e.hash),/["'() \t\n]|(%20)/.test(t)||e.needQuotes?'"'.concat(t.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):t):t}},744:t=>{"use strict";t.exports=function(t){return t[1]}},424:()=>{window._iconfont_svg_string_3243125='<svg><symbol id="icon-del" viewBox="0 0 1962 1024"><path d="M516.03573495-61.3921423h147.57736331l436.51830554 1109.1603911h-138.25668777l-118.06188999-310.68918553H334.28256162l-118.06189003 310.68918553H79.51743047L516.03573495-61.3921423zM374.67215602 629.89129437h428.75107557l-209.71520002-554.58019554h-6.21378331L374.67215602 629.89129437z m1171.29822779-407.00283222c114.9549989 0 198.8410789 29.51547221 254.76513221 90.09986335 46.60337778 52.8171611 71.45851221 125.82912 71.45851226 219.03587554v515.74404776h-116.50844447v-135.14979554c-31.0689189 43.49648555-73.0119589 79.22574222-122.72222778 107.18776889a407.77955555 407.77955555 0 0 1-200.39452444 49.71027c-80.77918777 0-144.47047111-20.19479666-192.62729444-60.5843911a202.53051221 202.53051221 0 0 1-74.56540444-161.55837668c0-91.65331001 35.72925667-160.00492999 110.29466002-206.60830777 65.24472889-43.49648555 158.45148445-66.79817443 279.62026667-68.35162112l192.62729552-3.10689222v-41.94303999c0-135.14979555-69.90506667-201.94796999-209.71519999-201.94797001-59.03094557 0-107.18776889 10.8741211-144.47047112 35.72925667-41.94304 24.85513443-68.35162112 63.69128334-80.77918886 114.95499779L1190.23126713 466.77947216c17.08790557-83.88608 59.03094557-147.57736334 124.27567447-187.96695668 59.03094557-37.28270222 135.14979555-55.92405334 231.46344225-55.92405333z m201.94797111 439.62519668l-184.86006557 3.1068922c-180.19972779 3.10689223-270.29959111 62.13783666-270.29959111 178.64628113 0 37.28270222 13.98101333 66.79817443 45.04993223 91.65330998 31.0689189 23.30168889 71.45851221 35.72925667 121.16878222 35.72925668 76.11884999 0 142.91702557-24.85513443 201.94797-74.56540444 57.47749888-48.15682333 86.99297223-104.08087666 86.99297223-166.21871445v-68.3516211z"  ></path><path d="M-114.66331065 521.15007993V424.05970993h2233.07851891v97.09037z"  ></path></symbol><symbol id="icon-link" viewBox="0 0 1024 1024"><path d="M613.40845063 417.35211313c74.3661975 74.3661975 74.3661975 196.05633844-1e-8 270.42253499L437.6338025 856.7887325c-74.3661975 74.3661975-196.05633844 74.3661975-270.422535 0s-74.3661975-196.05633844 0-270.422535l81.12676031-74.3661975 6.76056375-6.76056375c6.76056375-6.76056375 13.52112656-6.76056375 27.04225313-6.76056281 20.28169031 0 40.56338063 20.28169031 40.56338062 40.56337969-6.76056375 13.52112656-13.52112656 27.04225312-20.28169031 33.80281687L221.29577469 647.2112675c-40.56338063 40.56338063-40.56338063 108.16901437 0 148.73239406 40.56338063 40.56338063 108.16901437 40.56338063 148.73239406 0l175.77464813-175.77464718c40.56338063-40.56338063 54.08450719-108.16901437 13.52112656-148.73239501 0 0-6.76056375-6.76056375-13.52112656-6.76056281s-6.76056375-6.76056375-6.76056375-6.76056375c-13.52112656-13.52112656-13.52112656-20.28169031-13.52112657-27.04225312 0-20.28169031 20.28169031-40.56338063 40.56338063-40.56338063 13.52112656 0 20.28169031 6.76056375 27.04225312 13.52112657 6.76056375 0 13.52112656 6.76056375 20.28169032 13.52112749zM856.7887325 167.2112675c74.3661975 74.3661975 74.3661975 196.05633844 0 270.422535L775.66197219 512c0 6.76056375-6.76056375 6.76056375-6.76056375 6.76056375-6.76056375 6.76056375-13.52112656 6.76056375-20.28169031 6.76056281-20.28169031 0-40.56338063-20.28169031-40.56337969-40.56337969 0-13.52112656 6.76056375-27.04225312 20.28168937-33.80281687l67.60563375-81.12676125c40.56338063-40.56338063 40.56338063-108.16901437 0-148.73239406-40.56338063-40.56338063-108.16901437-40.56338063-148.73239406 0L478.19718313 397.07042281c-40.56338063 40.56338063-60.84507 101.40845063-20.28169032 135.2112675 6.76056375 6.76056375 13.52112656 13.52112656 20.28169032 27.04225313 0 6.76056375 6.76056375 13.52112656 6.76056375 13.52112656 0 20.28169031-13.52112656 33.80281687-33.80281688 33.80281687-6.76056375 0-13.52112656 0-20.28169031-6.76056281l-6.76056375-6.76056375c-6.76056375 0-6.76056375-6.76056375-13.52112656-6.76056281-74.3661975-74.3661975-67.60563375-182.53521094 6.76056375-256.90140844l175.77464718-175.77464812c67.60563375-67.60563375 189.29577469-67.60563375 263.66197219 13.52112656z"  ></path></symbol><symbol id="icon-markdown" viewBox="0 0 1024 1024"><path d="M136.61967679 794.06129354V183.89138517h152.55677748l228.80656544 228.80656543 228.80656541-228.80656543h152.5281767v610.16990837h-152.5281767V399.74177882l-228.80656541 228.80656545-228.80656544-228.80656545v394.31951472h-152.55677748m1182.18632193 38.12489394z"  ></path></symbol><symbol id="icon-todo" viewBox="0 0 1024 1024"><path d="M896.04635421 468.84872419c8.63025493-12.94538297 8.63025493-30.20589283 0-38.83614776l-258.90765483-263.22278173c-17.26050987-21.5756379-47.46640384-8.63025493-47.46640271 17.26050987v155.34459221c-69.04204061 0-440.14301184 12.94538297-470.34890581 513.50018162 0 17.26050987 21.5756379 21.5756379 25.89076594 8.63025493 138.08408235-250.27739875 263.22278173-310.68918557 440.14301184-302.05892949v155.34459221c0 25.89076594 30.20589283 38.83614777 47.46640384 21.5756379l263.22278173-267.53790976z m0 0"  ></path></symbol><symbol id="icon-undo" viewBox="0 0 1024 1024"><path d="M127.95364579 468.84872419l258.90765483 263.22278173c17.26050987 17.26050987 47.46640384 4.31512803 47.46640271-21.5756379v-155.34459221c176.92023011-8.63025493 302.05892949 51.78153074 440.14301297 302.05892949 8.63025493 12.94538297 25.89076594 8.63025493 25.8907648-8.63025493-25.89076594-496.23967061-396.99173717-509.18505358-466.03377777-509.18505359V184.05030457c0-25.89076594-30.20589283-38.83614777-47.46640271-21.5756379l-258.90765483 263.22278172c-8.63025493 12.94538297-8.63025493 30.20589283 0 43.1512758z m0 0"  ></path></symbol><symbol id="icon-fill" viewBox="0 0 1024 1024"><path d="M826.94360937 933.875a78.94687527 78.94687527 0 0 1-78.77812527-79.17187473c0-43.70625 78.77812527-184.72499973 78.77812528-184.72500054S905.74985937 810.99687527 905.74985937 854.70312527A78.975 78.975 0 0 1 826.94360937 933.875zM118.24985965 541.72812473L459.12485965 203.07500027l340.875 338.65312446L459.12485965 880.43750027 118.24985965 541.72812473z m340.875-263.39062446L222.87485965 511.6625h472.78124973L459.12485965 278.33750027zM307.61548437 127.75625L345.49985937 90.125l113.62500028 112.95000027-37.884375 37.63125-113.62500027-112.95000027z"  ></path></symbol><symbol id="icon-radio" viewBox="0 0 1024 1024"><path d="M813.63 162.17H220.08c-59.58 0.02-107.86 48.31-107.88 107.88v485.58c0 59.59 48.3 107.91 107.88 107.93h593.55c59.58-0.06 107.86-48.35 107.88-107.93V270.05c-0.06-59.56-48.32-107.83-107.88-107.88zM692.59 536.34L422.88 697.78c-4.21 2.5-9.02 3.84-13.91 3.85-4.66 0.02-9.25-1.18-13.3-3.51a26.83 26.83 0 0 1-13.73-23.41v-322.9c0.02-14.92 12.13-27 27.05-26.99 4.89 0.01 9.69 1.34 13.89 3.86l269.71 161.44c12.75 7.59 16.95 24.08 9.36 36.84-2.28 3.85-5.51 7.06-9.36 9.36v0.02z"  ></path></symbol><symbol id="icon-align-left" viewBox="0 0 1024 1024"><path d="M539.99 823.979a36.01 36.01 0 1 1 0 72.021H148.024a36.01 36.01 0 1 1 0-72.021h391.964z m335.985-231.993a36.01 36.01 0 1 1 0 72.021h-727.95a36.01 36.01 0 1 1 0-72.021h727.95zM539.99 359.993a36.01 36.01 0 0 1 0 72.021H148.025a36.01 36.01 0 0 1 0-72.021h391.964zM875.975 128a36.01 36.01 0 1 1 0 72.021h-727.95a36.01 36.01 0 0 1 0-72.021h727.95z"  ></path></symbol><symbol id="icon-img" viewBox="0 0 1024 1024"><path d="M832 128a128 128 0 0 1 128 128v512a128 128 0 0 1-128 128H192A128 128 0 0 1 64 768V256a128 128 0 0 1 128-128h640zM704 498.916L473.43 729.429a36.01 36.01 0 0 1-50.461 0.455l-0.398-0.455L320 626.916 146.375 800.484a55.922 55.922 0 0 0 44.715 23.495H832a56.036 56.036 0 0 0 55.979-55.069v-86.016L704 498.916zM832.91 200.02H192a56.036 56.036 0 0 0-55.979 55.069l-0.057 453.973 158.607-158.492a36.01 36.01 0 0 1 50.46-0.455L448 653.084l230.57-230.513a36.01 36.01 0 0 1 50.461-0.455L887.98 581.063V256a55.979 55.979 0 0 0-55.069-55.979zM311.98 320a55.979 55.979 0 1 1 0 112.014 55.979 55.979 0 0 1 0-112.014z"  ></path></symbol><symbol id="icon-align-middle" viewBox="0 0 1024 1024"><path d="M64 176c0 17.6 14.4 32 32 32h832c17.6 0 32-14.4 32-32s-14.4-32-32-32H96c-17.6 0-32 14.4-32 32zM720 368H304c-17.6 0-32 14.4-32 32s14.4 32 32 32h416c17.6 0 32-14.4 32-32s-14.4-32-32-32zM96 656h832c17.6 0 32-14.4 32-32s-14.4-32-32-32H96c-17.6 0-32 14.4-32 32s14.4 32 32 32zM304 880h416c17.6 0 32-14.4 32-32s-14.4-32-32-32H304c-17.6 0-32 14.4-32 32s14.4 32 32 32z"  ></path></symbol><symbol id="icon-font-size" viewBox="0 0 1024 1024"><path d="M296 587.2l89.6-288 89.6 288H296m169.6-398.4h-136L126.4 835.2h94.4l48-153.6h236.8l49.6 153.6H672L465.6 188.8m214.4 496l51.2-137.6 51.2 137.6h-102.4m99.2-201.6h-78.4l-64 171.2 27.2 86.4v-1.6h137.6l28.8 89.6h68.8l-120-345.6"  ></path></symbol><symbol id="icon-clear-style" viewBox="0 0 1024 1024"><path d="M812.9375 623.09375c12.65625 12.65625 12.65625 32.34375 0 45l-59.0625 59.0625 59.0625 59.0625c12.65625 12.65625 11.25 32.34375-1.40625 45-12.65625 11.25-30.9375 11.25-43.59375 0L708.875 772.15625l-59.0625 59.0625c-12.65625 12.65625-32.34375 12.65625-45 1.40625-12.65625-12.65625-12.65625-32.34375-1.40625-45l1.40625-1.40625 59.0625-59.0625-60.46875-60.46875c-12.65625-12.65625-11.25-32.34375 1.40625-45 12.65625-11.25 30.9375-11.25 43.59375 0l59.0625 59.0625 59.0625-59.0625c14.0625-11.25 33.75-11.25 46.40625 1.40625zM440.28125 776.375c16.875 0 32.34375 14.0625 32.34375 32.34375s-14.0625 32.34375-32.34375 32.34375H247.625c-16.875 0-32.34375-14.0625-32.34375-32.34375s14.0625-32.34375 32.34375-32.34375h192.65625zM686.375 182.9375c16.875 0 32.34375 14.0625 32.34375 32.34375 0 16.875-14.0625 32.34375-32.34375 32.34375H492.3125l-98.4375 459.84375c-4.21875 16.875-19.6875 28.125-36.5625 25.3125-15.46875-2.8125-26.71875-16.875-23.90625-33.75v-1.40625l97.03125-450H234.96875c-16.875 0-32.34375-12.65625-32.34375-30.9375s12.65625-32.34375 30.9375-32.34375h2.8125l450-1.40625z"  ></path></symbol><symbol id="icon-header" viewBox="0 0 1024 1024"><path d="M240.08837891 165.93066406h74.15771484v692.13867188h-74.15771484zM709.75390625 165.93066406h74.15771484v692.13867188h-74.15771484zM314.24609375 474.92114258h395.5078125v74.15771484H314.24609375z"  ></path></symbol><symbol id="icon-code" viewBox="0 0 1024 1024"><path d="M589.59536318 191.10837358l88.5316238 33.56626797-248.31463276 655.56009806-88.53162251-33.56626666zM342.22759325 378.11367379L208.34126705 512l133.8863262 133.88632621L275.28443015 712.87683187 74.40759828 512 275.28443015 311.12316813zM651.18875497 418.49735053l133.88632619 133.88632622-133.93366877 133.93366875 66.99050567 66.94316311 200.82948931-200.82948931-200.82948931-200.87683187z"  ></path></symbol><symbol id="icon-bold" viewBox="0 0 1024 1024"><path d="M258.58918381 859.61428833V164.38571167h293.38645935c32.32812881 0 70.56570053 20.16162873 100.11291504 52.14214326 34.76142883 37.54234314 53.8802147 87.25118637 53.5326004 138.69810103 0 53.8802147-19.81401443 101.85098647-52.83737183 138.00287248 18.42355728 8.6903572 36.49950027 21.20447158 52.48975755 36.49950027 38.23757172 36.15188599 60.13727188 86.90357209 59.78965758 139.39332962 0 52.83737182-21.55208588 103.24144363-59.78965758 139.39332962-31.98051453 30.93767166-73.34661484 50.7516861-107.76042939 51.09930038H258.58918381z m67.08955765-67.08955764h271.13914489c15.64264297 0 41.36610031-12.16650009 62.22295762-31.98051453 50.40407181-47.6231575 52.83737182-126.87921524 5.5618286-177.28328706-1.73807144-1.73807144-3.47614289-3.82375718-5.5618286-5.5618286-20.50924301-19.81401443-45.88508606-31.98051453-61.87534333-31.98051453H325.67874146v246.80614472z m0-313.89570237h226.64451599c7.29990006-0.69522858 14.25218582-3.1285286 20.50924301-6.60467148 10.42842865-5.56182862 20.8568573-13.55695725 30.24244308-23.9853859 23.29015732-25.37584305 36.15188599-58.74681473 35.8042717-93.16062927 0-36.84711457-13.20934297-68.82762909-35.8042717-93.16062927-8.6903572-9.73320007-19.11878586-17.72832871-30.24244308-23.98538589-6.25705719-3.47614289-13.20934297-5.9094429-20.16162873-6.60467148H325.67874146v247.50137329z"  ></path></symbol><symbol id="icon-align-right" viewBox="0 0 1024 1024"><path d="M875.968 824a36.032 36.032 0 1 1 0 72H484.032a36.032 36.032 0 1 1 0-72h391.936z m0-232a36.032 36.032 0 1 1 0 72H148.032a36.032 36.032 0 1 1 0-72h727.936z m0-232a36.032 36.032 0 1 1 0 72H484.032a36.032 36.032 0 0 1 0-72h391.936z m0-232a36.032 36.032 0 1 1 0 72H148.032a36.032 36.032 0 0 1 0-72h727.936z"  ></path></symbol><symbol id="icon-underline" viewBox="0 0 1024 1024"><path d="M729.52318152 811.41957328a35.69774168 35.69774168 0 1 1 0 71.34251925H293.31161033a35.69774168 35.69774168 0 0 1-1e-8-71.34251925h436.21157121z m0-669.94173881a35.69774168 35.69774168 0 0 1 35.69774095 35.06217386v275.67766222c0 175.15197477-91.73366176 281.87445107-253.6975987 281.87445106-160.32205255 0-251.84385862-104.65687976-253.6975987-276.63101468V177.22854027A35.69774168 35.69774168 0 0 1 329.2212077 176.64593581v275.73062633a237.06690049 237.06690049 0 0 0 46.29054337 157.0912486 169.48482627 169.48482627 0 0 0 135.79971699 53.33475573 169.85557428 169.85557428 0 0 0 136.01157271-53.38771983 235.372052 235.372052 0 0 0 46.29054336-155.02565208V177.22854027a35.69774168 35.69774168 0 0 1 35.69774097-35.69774169z"  ></path></symbol><symbol id="icon-color" viewBox="0 0 1024 1024"><path d="M541.59588823 134.45643971L541.93477199 135.24716951l294.60334343 606.65922378a33.15417237 33.15417237 0 0 1-59.41769873 29.42644558v-0.50832565L673.87369319 558.4005911H350.46519135l-103.13376277 212.42392213a33.15417237 33.15417237 0 0 1-43.77254365 15.58867314H203.05055851a33.15417237 33.15417237 0 0 1-15.53219356-43.77254364v-0.50832642L482.29115026 135.30364988A33.15417237 33.15417237 0 0 1 541.53940709 134.51292007z m-29.48292672 91.10337298L382.65919203 492.1487275h258.8510586z m-261.44917105 615.63965506h522.8983421a33.15417237 33.15417237 0 0 1 0 66.30834475H250.66379046a33.15417237 33.15417237 0 0 1 0-66.30834475z"  ></path></symbol></svg>',function(t){var e,n=(e=(e=document.getElementsByTagName("script"))[e.length-1]).getAttribute("data-injectcss");if(!(e=e.getAttribute("data-disable-injectsvg"))){var o,r,i,s,a;if(n&&!t.__iconfont__svg__cssinject__){t.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(e){console&&console.log(e)}}o=function(){var e,n=document.createElement("div");n.innerHTML=t._iconfont_svg_string_3243125,(n=n.getElementsByTagName("svg")[0])&&(n.setAttribute("aria-hidden","true"),n.style.position="absolute",n.style.width=0,n.style.height=0,n.style.overflow="hidden",(e=document.body).firstChild?function(t,e){e.parentNode.insertBefore(t,e)}(n,e.firstChild):e.appendChild(n))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(o,0):(r=function(){document.removeEventListener("DOMContentLoaded",r,!1),o()},document.addEventListener("DOMContentLoaded",r,!1)):document.attachEvent&&(i=o,s=t.document,a=!1,function t(){try{s.documentElement.doScroll("left")}catch(e){return void setTimeout(t,50)}l()}(),s.onreadystatechange=function(){"complete"==s.readyState&&(s.onreadystatechange=null,l())})}function l(){a||(a=!0,i())}}(window)},592:(t,e,n)=>{"use strict";n.d(e,{c:()=>p});var o=n(744),r=n.n(o),i=n(888),s=n.n(i),a=n(864),l=n.n(a),c=new URL(n(392),n.b),d=s()(r()),h=l()(c);d.push([t.id,`.editor-tool-bar{border:solid 1px #eee;background:#282828;padding:6px}.editor-tool-bar .icon{width:1.2em;height:1.2em;vertical-align:-.15em;fill:currentColor;overflow:hidden}.editor-tool-bar .editor-tool-bar-item{padding:4px 10px;display:inline-block;border-radius:4px;cursor:pointer;user-select:none}.editor-tool-bar .editor-tooltip{position:relative;display:inline-block}.editor-tool-bar .editor-tooltip .tooltiptext{opacity:0;width:60px;font-size:12px;background-color:#000;color:#fff;text-align:center;border-radius:6px;padding:5px 0;position:absolute;z-index:1;top:140%;left:50%;margin-left:-30px;transition:opacity 600ms ease-out}.editor-tool-bar .editor-tooltip .tooltiptext::after{content:'';position:absolute;left:50%;margin-left:-5px;border-width:5px;border-style:solid}.editor-tool-bar .editor-tooltip:hover .tooltiptext{opacity:1}.editor-tool-bar .editor-tooltip .tooltiptext.bottom{top:140%}.editor-tool-bar .editor-tooltip .tooltiptext.bottom::after{bottom:100%;border-color:transparent transparent #000 transparent}.editor-tool-bar .editor-tooltip .tooltiptext.top{top:-140%}.editor-tool-bar .editor-tooltip .tooltiptext.top::after{top:100%;border-color:#000 transparent transparent transparent}.color-picker-container{background:#eee;padding:10px}.color-picker-container .btn.submit{height:24px;text-align:center;color:#fff;background:#325cff;margin-top:10px;border-radius:2px;font-size:14px;line-height:24px}.color-picker-container .control-panel{display:flex;justify-content:space-between;margin-top:4px}.color-picker-container .control-panel .left .cursor{display:inline-block;position:relative;width:6px;height:12px;transform:translateY(-1px);background-color:#f8f8f8;box-shadow:rgba(0,0,0,0.37) 0 1px 4px 0}.color-picker-container .control-panel .left .slider-bar{font-size:0;height:10px;width:200px}.color-picker-container .control-panel .left .hue-slider{background:linear-gradient(to left,#f00,#ff0,#0f0,#0ff,#00f,#f0f,#f00)}.color-picker-container .control-panel .left .transparency-slider{position:relative;background:url(${h}) left center}.color-picker-container .control-panel .left .transparency-slider .transparency-gradient{height:100%}.color-picker-container .control-panel .right{position:relative;cursor:pointer}.color-picker-container .control-panel .right .color-block{width:24px;height:24px;position:absolute;top:0}.color-picker-container .control-panel .right .color-block-bg{width:24px;height:24px;background:url(${h}) left center}.color-picker-container .palette{width:228px;height:150px;overflow:hidden;border:#eee solid 1px}.color-picker-container .palette .cursor{pointer-events:none;display:inline-block;position:relative;width:12px;height:12px;border-radius:50%;box-shadow:#fff 0 0 0 1px inset;transform:translate(-6px,-6px)}.divider{margin:10px 0}.divider-height-1{border-top-width:1px}.divider-height-2{border-top-width:2px}.divider-color-black{border-top-color:#000}.divider-color-red{border-top-color:#f00}.divider-color-gray{border-top-color:#aaa}.divider-solid{border-top-style:solid}.divider-dashed{border-top-style:dashed}`,""]);const p=d},196:(t,e,n)=>{"use strict";n.d(e,{c:()=>a});var o=n(744),r=n.n(o),i=n(888),s=n.n(i)()(r());s.push([t.id,"#editor-content:focus,.custom-input:focus{outline:none}#editor-content{word-break:break-all;padding:15px}#editor-content .custom-input-iframe{top:-100px;left:0;background:transparent;color:transparent;width:0;height:0;pointer-events:none;border:none;caret-color:transparent;position:absolute}#editor-content .custom-caret{top:-100px;left:0;pointer-events:none;position:absolute;width:2px;border:none;padding:0;display:block;animation:caret 1s infinite .5s steps(1,start)}#editor-content .editor-disabled{user-select:none}#editor-content ::selection{background:#bad2fa}#editor-content table td,#editor-content td{background-color:#fff}#editor-content table td,#editor-content th,#editor-content td{display:table-cell;margin:0;padding:0;text-align:left;vertical-align:middle}@-moz-keyframes static-caret{0%{opacity:1}100%{opacity:1}}@-webkit-keyframes static-caret{0%{opacity:1}100%{opacity:1}}@-o-keyframes static-caret{0%{opacity:1}100%{opacity:1}}@keyframes static-caret{0%{opacity:1}100%{opacity:1}}@-moz-keyframes caret{0%{opacity:1}50%{opacity:0}100%{opacity:1}}@-webkit-keyframes caret{0%{opacity:1}50%{opacity:0}100%{opacity:1}}@-o-keyframes caret{0%{opacity:1}50%{opacity:0}100%{opacity:1}}@keyframes caret{0%{opacity:1}50%{opacity:0}100%{opacity:1}}",""]);const a=s},764:t=>{"use strict";var e=[];function n(t){for(var n=-1,o=0;o<e.length;o++)if(e[o].identifier===t){n=o;break}return n}function o(t,o){for(var i={},s=[],a=0;a<t.length;a++){var l=t[a],c=o.base?l[0]+o.base:l[0],d=i[c]||0,h="".concat(c," ").concat(d);i[c]=d+1;var p=n(h),u={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==p)e[p].references++,e[p].updater(u);else{var f=r(u,o);o.byIndex=a,e.splice(a,0,{identifier:h,updater:f,references:1})}s.push(h)}return s}function r(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,r){var i=o(t=t||[],r=r||{});return function(t){t=t||[];for(var s=0;s<i.length;s++){var a=n(i[s]);e[a].references--}for(var l=o(t,r),c=0;c<i.length;c++){var d=n(i[c]);0===e[d].references&&(e[d].updater(),e.splice(d,1))}i=l}}},668:t=>{"use strict";var e={};t.exports=function(t,n){var o=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(n)}},456:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},252:(t,e,n)=>{"use strict";t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},520:t=>{"use strict";t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var o="";n.supports&&(o+="@supports (".concat(n.supports,") {")),n.media&&(o+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(o+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),o+=n.css,r&&(o+="}"),n.media&&(o+="}"),n.supports&&(o+="}");var i=n.sourceMap;i&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleTagTransform(o,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},992:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},392:t=>{"use strict";t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAADFJREFUOE9jZGBgEGHAD97gk2YcNYBhmIQBgWSAP52AwoAQwJvQRg1gACckQoC2gQgAIF8IscwEtKYAAAAASUVORK5CYII="}},e={};function n(o){var r=e[o];if(void 0!==r)return r.exports;var i=e[o]={id:o,exports:{}};return t[o](i,i.exports,n),i.exports}n.m=t,n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.b=document.baseURI||self.location.href,n.nc=void 0,(()=>{"use strict";var t={};n.r(t),n.d(t,{classCheck:()=>z,computeLen:()=>w,debounce:()=>S,isClass:()=>F,isDef:()=>x,isFunction:()=>V,isPrimitive:()=>C,isUndef:()=>b,mergeObj:()=>P,mergePointsContainer:()=>N,mergeTextPath:()=>H,multiplication:()=>A,positionCompare:()=>$,setStyle:()=>R,stringify:()=>L,styleToObj:()=>M,throttle:()=>k,times:()=>B,toRawType:()=>E,typeOf:()=>_,uuid:()=>T});var e={};n.r(e),n.d(e,{Caret:()=>Me,appendChild:()=>nn,createElm:()=>Ke,domToVNode:()=>rn,initIntercept:()=>Je,insertBefore:()=>tn,nativeDocument:()=>Qe,nativeSelection:()=>Ze,nativeWindow:()=>We,removeChild:()=>on,replaceChild:()=>en,updateProps:()=>Ue});const o={VFUNCTION:1,VCOMPONENT:2,VTEXT:3,VDOM:4},r=new WeakMap,i=new WeakMap,s=new WeakMap,a=new WeakMap,{VFUNCTION:l,VCOMPONENT:c,VTEXT:d}=o;function h(t){return s.get(t)}function p(t){if(t.vnodeType){const e=a.get(t);if(e)return e;if(t.vnodeType===d)return null;const n=h(t),o=u(n);return n.vnodeType===l?a.get(n):a.get(o)}{const e=a.get(t);if(!e)return;return e}}function u(t){return i.get(t)}function f(t){return t.vnodeType===l?r.get(s.get(t)):t.vnodeType===c?r.get(s.get(i.get(t))):r.get(t)}function m(t,e){r.set(e,t).set(t,e)}function g(t,e){i.set(e,t).set(t,e)}function y(t,e){a.set(t,e).set(e,t)}function v(t,e){return s.set(e,t).set(t,e)}function b(t){return null==t}function x(t){return null!=t}function C(t){return"string"==typeof t||"number"==typeof t||"symbol"==typeof t||"boolean"==typeof t}function w(t){return C(t.node.data)?t.node.data.length:t.children.length?t.children.reduce(((t,e)=>t+w(e)),0):0}function k(t,e,n=!0){let o,r,i;return function(){const s=this,a=arguments;o?(clearTimeout(r),r=setTimeout((function(){Date.now()-i>=e&&(t.apply(s,a),i=Date.now())}),Math.max(e-(Date.now()-i),0))):(n&&t.apply(s,a),i=Date.now(),o=!0)}}function S(t,e=0){let n;return function(...o){clearTimeout(n),n=setTimeout((()=>t.apply(this,o)),e)}}window.aa={setVdomOrElm:m,setVnodeOrIns:g,setVdomOrPath:y,getVdomOrElm:f,getVdomOrPath:p,getVnodeOrIns:u};const O=Object.prototype.toString;function E(t){return O.call(t).slice(8,-1).toLowerCase()}function R(t,e){for(const n in e)t.style[n]=e[n]}function A(t,e){return t.replace(/(\d*).*/,(function(t,n){return n*e}))}function L(t){let e=[],n=JSON.stringify(t,((t,n)=>{if("object"==typeof n&&null!==n){if(-1!==e.indexOf(n))return"Circular reference";e.push(n)}return n}));return e=null,n}function M(t){return(t=t.trim()).split(";").filter((t=>t)).reduce(((t,e)=>{const n=e.split(":");return t[n[0].trim()]=n[1].trim(),t}),{})}function T(){return([1e3]+-1e3+-4e3+-8e3).replace(/[018]/g,(t=>(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)))}function P(t,e){for(let n in e)e.hasOwnProperty(n)&&b(t[n])&&!b(e[n])&&(t[n]=e[n])}function B(t,e,n=void 0,...o){let r=0;for(;r++<t;)e.call(n,...o)}function $(t,e){if(t===e)return 0;if(t.originOf(e))return-1;if(e.originOf(t))return 1;const n=t.position.split("-"),o=e.position.split("-"),r=Math.min(n.length,o.length);for(let t=0;t<r;t++){const e=+n[t],r=+o[t];if(e>r)return 1;if(e<r)return-1}}function _(t){return Object.prototype.toString.call(t).slice(8,-1)}function z(t,e,n){if(t===e)throw new Error(`${e.name} class can\`t instantiate`);n.forEach((e=>{if(!t.prototype.hasOwnProperty(e))throw new Error(`please overwrite ${e} method`)}))}function N(t,e,n){n.selection.rangePoints.filter((e=>e.container===t)).forEach((t=>{"start"===t.pointName?t.range.setStart(e,e.length+t.offset):t.range.setEnd(e,e.length+t.offset)}))}function H(t,e){const n=t[0],o=t.length;if(1===o)return n;for(let t=0;t<o-1;t++)N(n.nextSibling,n,e),n.node.data+=n.nextSibling.node.data,n.nextSibling.delete();return n}function F(t){return"function"==typeof t&&/^class\s/.test(Function.prototype.toString.call(t))}function V(t){return"function"==typeof t&&/^function\s/.test(Function.prototype.toString.call(t))}class I{rebuildFlag=0;_uuid=T();render(){return this.$editor.formater.render(this)}node=null;parent=null;index=0;prevSibling=null;nextSibling=null;children=[];constructor({node:t,parent:e,index:n,prevSibling:o,nextSibling:r,children:i}){this.node=t,this.parent=e,this.index=n,this.prevSibling=o,this.nextSibling=r,this.children=i}get rootPath(){let t=this;for(;t.parent;)t=t.parent;return t}get isBlock(){return this===this?.component.$path&&"block"===this?.component.displayType}get $editor(){return this._editor||this.parent.$editor}get component(){return this._$component||this.parent?.component}get length(){return w(this)}get elm(){return f(this.vn)}get pathType(){switch(this.dataType){case"String":return 3;case"Object":return 2;case"Array":return 1}}get dataType(){return _(this.node.data)}get block(){return"block"===this.component?.displayType?this.component:this.parent.block}get vn(){return p(this)}get isLeaf(){return 0===this.children.length}get firstLeaf(){let t=this;for(;t.children&&t.children.length;)t=t.children[0];return t}get lastLeaf(){let t=this;for(;t.children&&t.children.length;)t=t.children[t.children.length-1];return t}get position(){return this.parent?`${this.parent.position}-${this.index}`:"0"}get prevLeaf(){return(this.prevSibling||this.parent?.prevLeaf)?.lastLeaf}get nextLeaf(){return(this.nextSibling||this.parent?.nextLeaf)?.firstLeaf}queryCommonPath(t){if(this===t)return this;if("0"===this.position)return this;if("0"===t.position)return t;const e=this.rootPath,n=this.position.split("-"),o=t.position.split("-"),r=Math.min(n.length,o.length);let i;for(i=0;i<r&&n[i]===o[i];i++);return K(n.slice(0,i).join("-"),e)}textInsert(t,e){this.node.data=this.node.data.slice(0,t)+e+this.node.data.slice(t)}textDelete(t,e){const n=this.node.data.slice(t-e,t);return this.node.data=this.node.data.slice(0,t-e)+this.node.data.slice(t),n}clearFormat(){this.node.formats={}}setNode({data:t="",formats:e={}}={}){this.node.data=t,this.node.formats=e}setFormat(t){Object.assign(this.node.formats,t)}split(t){if(3===this.pathType){const e=D({data:this.node.data.slice(t),formats:{...this.node.formats}});return this.textDelete(this.length,this.length-t),e.insertAfter(this),[this,e]}{const e=D({data:[],formats:{...this.node.formats}});return this.children.slice(t).forEach((t=>{t.moveTo(e)})),e.insertAfter(this),[this,e]}}clone(t=!1){let e;return e=t?C(this.node.data)?this.node.data:JSON.parse(JSON.stringify(this.node.data)):C(this.node.data)?"":this.node.data?[]:{},D({data:e,formats:{...this.node.formats}})}positionCompare(t){return $(this,t)}originOf(t){return this.position.includes(t.position+"-")}insertBefore(t){this.delete(),t.parent.splice(t.index,0,this)}insertAfter(t){this.delete(),t.parent.splice(t.index+1,0,this)}moveTo(t){this.delete(),t.push(this)}delete(){this.parent&&(this.rebuildFlag=1,this.parent.rebuild(),this.parent.component.update())}push(...t){t.forEach((t=>t.rebuildFlag=0)),this.children.push(...t),this.rebuild(),this.component.update()}pop(){const t=this.children[this.children.length-1];return t.rebuildFlag=1,this.rebuild(),this.component.update(),t}unshift(...t){t.forEach((t=>t.rebuildFlag=0)),this.children.unshift(...t),this.rebuild(),this.component.update()}shift(){const t=this.children[0];return t.rebuildFlag=1,this.rebuild(),this.component.update(),t}splice(t,e,...n){const o=[];if(n.length&&(n.forEach((t=>t.rebuildFlag=0)),this.children.splice(t,0,...n)),e>0)for(let n=0;n<e;n++){const e=this.children[n+t];e.rebuildFlag=1,o.push[e]}return this.rebuild(),this.component.update(),o}deleteBetween(t,e){if(this===t||this===e||t===e)return;const n=[],o=r=>{for(var i=0;i<r.children.length;i++){const s=r.children[i];t.originOf(s)||e.originOf(s)?o(s):1===s.positionCompare(t)&&-1===s.positionCompare(e)&&(s.rebuildFlag=1,n.includes(s.parent)||n.push(s.parent))}};o(this),n.forEach((t=>t.rebuild()))}rebuild(t=!1){if("Array"!==this.dataType)return;let e=null;this.children=this.children.filter((t=>1!==t.rebuildFlag)),this.node.data.length=0,this.children.forEach(((t,n)=>{t.parent=this,this.node.data.push(t.node),t.prevSibling=e,e&&(e.nextSibling=t),t.nextSibling=null,e=t,t.index=n}))}}function D(t,e=null,n=null,o=null,r=0){t.formats||(t.formats={});const i=new I({node:t,parent:e,index:r,prevSibling:n,nextSibling:o,children:[]});if(t.data){let e=null;t.data.reduce?.(((t,n,o)=>(e=D(n,i,t,null,o),t&&(t.nextSibling=e),e.prevSibling=t,i.children.push(e),e)),null)}return i}function j(t,e){if(t instanceof I)return t;if(t.nodeType)return function(t){const e=f(t);return e?U(e):null}(t);if(t.vnodeType)return U(t);if("string"==typeof t)return K(t,e);throw"queryPath的参数必须是elm|vn|position"}function U(t){return p(t)||null}function K(t,e){return t.split("-").slice(1).reduce(((t,e)=>t.children[e]),e)}const q=["ref","key","ns"],G=["ns"],{VFUNCTION:X,VCOMPONENT:Y,VTEXT:J,VDOM:Q}=o;function W(t,e,n=[]){e=e||{};const o={},r={};for(let t of q)r[t]=e[t]||null;for(let t in e)q.includes(t)||("style"===t&&C(e[t])?o[t]=M(e[t]):o[t]=e[t]);return function(t,e,n,o){let r;if("text"===t)r={_uuid:T(),vnodeType:J,tag:"text",children:o.join("")};else{r={_uuid:T(),vnodeType:F(t)?Y:V(t)?X:Q,tag:t,...e,props:n};const i={};for(let t of G)i[t]=r[t];r.vnodeType===X||r.vnodeType===Y?r.props.children=Z(o,i):r.children=Z(o,i)}return r}(t,r,o,n.flat())}const Z=(t,e)=>t.filter((t=>""!==t)).map((t=>C(t)||b(t)?{_uuid:T(),tag:"text",vnodeType:J,children:t}:(P(t,e),t))),tt=class{formatMap=new Map;register(t){t.forEach((t=>{this.formatMap.set(t.name,t)}))}inject(t,e){this[t]=e}renderRoot(t){return this.render({children:[t]})}render(t){const e=this._group({paths:t.children,restFormats:this.types},0);return this._generateGroups(e,t.isBlock&&0===t.length)}_invokeRender(t,e){return e.fmt.render(t,e.value,W)}_generateGroups(t,e){return t.map((t=>{let n;const o=this._getFormats(t.commonFormats);if(0===t.commonFormats.length){if(-1!==t.children.findIndex((t=>"object"==typeof t.node.data)))throw"格式标记不合法,文本格式不可用于标记非文本的结构";const n=H(t.children,this.editor);let o=null;return e?(o=W("br"),y(n,n.parent.vn),n.clearFormat()):(""===n.node.data&&console.warn("非法空标签：",n),o=W("text",{},[n.node.data]),y(n,o)),o}if((n=o.filter((t=>"component"===t.fmt.type))).length){const e=t.children[0],o=n[0].fmt.render(null,{path:e,editor:this.editor},n[0].value,W);return y(e,o),o}{let n=null,r=null;const i=[];for(let t=0;t<o.length;t++){const e=o[t];"attribute"!==e.fmt.type?(r=this._invokeRender(r,e),n||(n=r)):i.push(e)}for(let t=0;t<i.length;t++){const e=i[t],o=this._invokeRender(r,e);o&&(r=o),n||(n=o)}if(t.children[0].commonFormats)r.children=this._generateGroups(t.children,e);else{if(-1!==t.children.findIndex((t=>"object"==typeof t.data)))throw"格式标记不合法,文本格式不可用于标记非文本的结构";const n=H(t.children,this.editor);let o=null;e?(o=W("br"),y(n,r),n.clearFormat()):(""===n.node.data&&console.warn("非法空标签：",n),o=W("text",{},[n.node.data]),y(n,o)),r.children=[o]}return n}})).filter((t=>t))}get types(){return[...this.formatMap.keys()]}_getFormats(t){return t.map((t=>{const e=Object.keys(t)[0];return{fmt:this.formatMap.get(e),value:t[e]}}))}get(t){return this.formatMap.get(t)||{}}_canAdd(t,e,n){return!!t.node.formats[n]&&(!e.node.formats[n]||e.node.formats[n]===t.node.formats[n]||void 0)}_group(t,e,n=[]){const o={commonFormats:[],children:[]};let r=[],i=null,s={},a=0;for(;e<t.paths.length;e++){let n={...s};const l=t.paths[e];t.restFormats.forEach((t=>{i?this._canAdd(l,i,t)&&s[t]++:(s[t]=0,l.node.formats[t]&&s[t]++)}));const c=Math.max(...Object.values(s));if(i&&Object.keys(l.node.formats).some((t=>"component"===this.get(t).type))){i=null;break}if(i&&Object.keys(i.node.formats).some((t=>"component"===this.get(t).type))){i=null;break}if(i&&0===a&&c>a){s=n;break}if(i&&c===a&&0!==c){s=n;break}o.children.push(l),o.commonFormats=Object.entries(s).filter((t=>t[1]&&t[1]===c)).map((n=>({[n[0]]:t.paths[e].node.formats[n[0]]}))),r=t.restFormats.filter((t=>!o.commonFormats.some((e=>e[t])))),a=c,i=l}return o.commonFormats.length>0&&o.children.length>1&&(o.children=this._group({paths:o.children,restFormats:r},0)),n.push(o),e<t.paths.length&&this._group(t,e,n),n}},{VFUNCTION:et,VCOMPONENT:nt,VTEXT:ot}=o;function rt(t,e){return t?.key===e?.key&&t?.tag===e?.tag}function it(t,e,n,o){for(let r=n;r<o;r++){const n=e[r];if(x(n)&&rt(t,n))return r}}function st(t,e,n){const o={};for(let r=e;r<=n;++r){const e=t[r]?.key;x(e)&&(o[e]=r)}return o}function at(t,e){if(![1,2].includes(t.vnodeType))return;const n=u(t),o=h(n);if(n?.onBeforeUnmount?.(),void 0!==o.children)for(let t=0;t<o.children.length;++t){const n=o.children[t];null!=n&&"string"!=typeof n&&at(n,e)}n&&e.push(n)}function lt(t){switch(t.vnodeType){case et:return h(t);case nt:return h(u(t));default:return t}}function ct(t){return f(lt(t))}function dt(t,e){if(e!==t){if(t.vnodeType===et){const n=lt(e),o=t.tag(W,t.props);return v(o,t),dt(o,n)}if(t.vnodeType===nt){const n=lt(e),o=u(e);g(t,o),o.props=Object.freeze({...t.props});const r=o._generateVdom_(W);return v(o,r),g(o,t),dt(r,n)}if(t.vnodeType===ot){const n=f(e);return m(n,t),Pt.platform.updateProps(t,e),n}{const n=f(e);m(n,t);const o=e.children,r=t.children;return Pt.platform.updateProps(t,e),o!==r&&function(t,e,n){let o,r,i,s,a=0,l=0,c=n.length-1,d=e.length-1,h=n[0],p=e[0],u=n[c],g=e[d];for(;a<=c&&l<=d;)null===h?h=n[++a]:null===u?u=n[--c]:null===p?p=e[++l]:null===g?g=e[--d]:rt(p,h)?(dt(p,h),h=n[++a],p=e[++l]):rt(g,u)?(dt(g,u),u=n[--c],g=e[--d]):rt(g,h)?(dt(g,h),Pt.platform.insertBefore(t,ct(h),ct(u).nextSibling),h=n[++a],g=e[--d]):rt(p,u)?(dt(p,u),Pt.platform.insertBefore(t,ct(u),ct(h)),u=n[--c],p=e[++l]):(void 0===o&&(o=st(n,a,c)),r=x(p.key)?o[p.key]:it(p,n,a,c),b(r)?(Pt.platform.insertBefore(t,Pt.platform.createElm(p),ct(h)),pt(p,"onMounted")):(console.log(111),i=n[r],i.tag!==p.tag?(Pt.platform.insertBefore(t,Pt.platform.createElm(p),ct(h)),pt(p,"onMounted")):(dt(p,i),n[r]=null,Pt.platform.insertBefore(t,ct(i),ct(h)))),p=e[++l]);l<=d&&(s=null===e[d+1]?null:f(e[d+1]),function(t,e=null,n,o,r){for(;o<=r;++o){const r=n[o];if(null!=r){const n=Pt.platform.createElm(r);m(n,r),Pt.platform.insertBefore(t,n,e),pt(r,"onMounted")}}}(t,s,e,l,d)),a<=c&&function(t,e,n,o){for(;n<=o;++n){const o=e[n];if(null!=o){let e=[],n=ct(o);const r=[1,2].includes(o.vnodeType);n&&Pt.platform.removeChild(t,n),r&&at(o,e),e.forEach((t=>{"function"==typeof t.onUnmounted&&t.onUnmounted()})),e=null}}}(t,n,a,c)}(n,r,o),n}}}function ht(t,e){if(e!==t){if(!t){const t=u(e),n=h(t),o=t._generateVdom_(W);return v(t,o),dt(o,n),f(o)}if(b(e))return Pt.platform.createElm(t);if(x(e.nodeType)&&m(e,e=Pt.platform.domToVNode(e)),rt(t,e))dt(t,e);else{let n=ct(e);const o=Pt.platform.createElm(t);Pt.platform.replaceChild(n.parentNode,o,n),pt(e,"onUnmounted"),pt(t,"onMounted")}return ct(t)}}function pt(t,e){if(t.vnodeType!==nt)return;const n=u(t);n&&"function"==typeof n[e]&&n[e]()}const ut=[],ft=[];function mt(){let t,e;for(;t=ut.shift();){const{partialState:e,component:n}=t;n.prevState||(n.prevState=Object.assign({},n.state)),"function"==typeof e?Object.assign(n.state,e(n.prevState,n.props)):Object.assign(n.state,e),n.prevState=n.state}for(;e=ft.shift();)e.shouldComponentUpdate()&&e._syncUpdate_()}class gt{static isComponent=!0;get isComponent(){return!0}state={};$nextTick=t=>Promise.resolve().then(t);constructor(t){this.props=Object.freeze({...t})}render(t){throw Error('Component does not implement a required interface "render"')}_generateVdom_(t){return"function"==typeof this.onBeforeRender&&this.onBeforeRender(),this.render(t)}setState(t={}){return function(t,e){let n=null;var o;return 0===ut.length&&(o=mt,n=Promise.resolve().then(o)),ut.push({partialState:t,component:e}),ft.some((t=>t===e))||ft.push(e),n||Promise.resolve()}(t,this)}_syncUpdate_(){ht(null,u(this))}shouldComponentUpdate(){return!0}}function yt(t,e,n){if(e.inputState.isComposing)return;if(!e.collapsed&&!n.shiftKey)return void e.collapse("left"===t);const{shiftKey:o}=n;if(e.collapsed||o)return e.container.component.onCaretMove(t,e,n);e.collapse("left"===t)}function vt(t,e,n){e.inputState.isComposing||(e.collapsed||n.shiftKey?xt(e,"up"===t?"left":"right",{...e.caret.rect,block:e.container.block},{...e.caret.rect,block:e.container.block},!1,n):e.collapse("up"===t))}function bt(t,e,n,o){if(n.block!==e.block)return!1;let r=!0;return("left"===o&&n.x>e.x||"right"===o&&n.x<e.x)&&(r=!1),n.y===t.y&&(r=!0),r}function xt(t,e,n,o,r=!1,i){t.collapsed&&(t.d=0);const{path:s}=yt(e,t,i)||{};if(!s)return;t.updateCaret(!0);const a={...t.caret.rect,block:s.block},l=Math.abs(a.x-n.x);if(0!==l){if(r){const r=Math.abs(o.x-n.x),s=bt(n,o,a,e);if(!(l<=r&&s))return yt("left"===e?"right":"left",t,i),void t.updateCaret(!0)}if(a.x!==o.x||a.y!==o.y)return bt(n,o,a,e)||(r=!0),xt(t,e,n,a,r,i)}}function Ct({event:t,range:e,ts:n,force:o=!1}){if(e.inputState.isComposing&&!o)return;const{endContainer:r,startContainer:i}=e;i.queryCommonPath(r).component.onContentDelete({event:t,range:e,ts:n})}class wt{constructor(t){this.position=t.container.position,this.offset=t.offset,this.editor=t.editor}apply(){const t=this.editor.queryPath(this.position),e=this.applyAction({path:t,offset:this.offset});return t.component.update(),e}invert(){const t=this.editor.queryPath(this.position);this.invertAction({path:t,offset:this.offset}),t.component.update()}applyAction(){throw Error('Step does not implement a required interface "applyAction"')}invertAction(){throw Error('Step does not implement a required interface "invertAction"')}}class kt extends wt{constructor(t,e){super(t,e)}applyAction(t){const e=t.path.split(t.offset);return editor.selection.updatePoints(t.path,t.offset+1,-t.offset,e[1]),e}invertAction(t){H([t.path,t.path.nextSibling],t.editor)}}class St extends wt{constructor(t,e,n){super(t,e),this.format=n}applyAction(t){this.startFormats={...t.path.node.formats},Object.assign(t.path.node.formats,this.format),this.endFormats={...t.path.node.formats}}invertAction(t){t.path.node.formats=this.startFormats}}class Ot extends wt{constructor({range:t,count:e}){super(t),this.count=e}applyAction({path:t,offset:e}){this.deleteText=t.textDelete(e,this.count),editor.selection.updatePoints(t,e,-this.count)}invertAction({path:t,offset:e}){t.textInsert(e-this.count,this.deleteText),editor.selection.updatePoints(t,e-this.count,this.count)}}class Et extends wt{constructor({range:t,data:e}){super(t),this.data=e}applyAction({path:t,offset:e}){t.textInsert(e,this.data),this.editor.selection.updatePoints(t,e,this.data.length)}invertAction({path:t,offset:e}){t.textDelete(e+this.data.length,this.data.length),this.editor.selection.updatePoints(t,e+this.data.length,-this.data.length)}}class Rt{inputState={value:"",isComposing:!1};d=0;constructor(t,e){const{startContainer:n,endContainer:o,startOffset:r,endOffset:i,d:s}=t;this.endContainer=o,this.startContainer=n,this.endOffset=i,this.startOffset=r,this.editor=e,this.d=s,this.caret=new Pt.platform.Caret(this)}get collapsed(){return this.endContainer===this.startContainer&&this.endOffset===this.startOffset}get offset(){return 1===this.d?this.endOffset:this.startOffset}get container(){return 1===this.d?this.endContainer:this.startContainer}set offset(t){1===this.d?this.endOffset=t:this.startOffset=t,this.collapsed&&(this.d=0)}set container(t){1===this.d?this.endContainer=t:this.startContainer=t}get snapshot(){return{endContainer:this.endContainer.position,startContainer:this.startContainer.position,endOffset:this.endOffset,startOffset:this.startOffset,d:this.d}}set(t,e){return this.container=t,this.offset=e,this.collapsed&&(this.d=0),this}setEnd(t,e){return this.endContainer=t,this.endOffset=e,this.collapsed&&(this.d=0),this}setStart(t,e){return this.startContainer=t,this.startOffset=e,this.collapsed&&(this.d=0),this}collapse(t=!0){return t?(this.endContainer=this.startContainer,this.endOffset=this.startOffset):(this.startOffset=this.endOffset,this.startContainer=this.endContainer),this.d=0,this}updateCaret(t=!0){this.caret.update(t),setTimeout((()=>{this.editor.focus()}),200)}remove(){const t=this.editor.selection.ranges.findIndex((t=>t===this));this.caret.remove(),this.editor.selection.ranges.splice(t,1)}}class At{ranges=[];nativeSelection=Pt.platform.nativeSelection;constructor(t){this.editor=t}get collapsed(){return this.ranges.every((t=>t.collapsed))}get rangeCount(){return this.ranges.length}get rangePoints(){const t=[];return this.ranges.forEach((e=>{t.push({container:e.startContainer,offset:e.startOffset,range:e,pointName:"start"},{container:e.endContainer,offset:e.endOffset,range:e,pointName:"end"})})),t}get rangesSnapshot(){return this.ranges.map((t=>t.snapshot))}clearRanges(){for(;this.ranges.length;)this.ranges.pop().caret.remove()}createRange(t){return new Rt(t,this.editor)}createRangeFromNativeRange(t){const{startContainer:e,endContainer:n,startOffset:o,endOffset:r,collapsed:i}=t,{focusNode:s,focusOffset:a}=this.nativeSelection;let l=0;return l=i?0:s===n&&a===r?1:-1,this.createRange({startContainer:this.amendPathOffset(e).path,endContainer:this.amendPathOffset(n).path,startOffset:o,endOffset:r,d:l})}addRange(t){this.ranges.push(t)}collapse(t,e){this.nativeSelection.collapse(t,e),this._resetRangesFromNative()}amendPathOffset(t,e){const n=this.editor.queryPath(t);return n?n.isLeaf&&3!==n.pathType?this.amendPathOffset(n.elm.parentNode,n.index+1):{path:n,offset:e}:this.amendPathOffset(t.parentNode,e)}amendRange(t){const{startContainer:e,endContainer:n,startOffset:o,endOffset:r}=t,i=this.amendPathOffset(e,o),s=this.amendPathOffset(n,r);return t.setStart(i.path.elm,i.offset),t.setEnd(s.path.elm,s.offset),t}_resetRangesFromNative(){this.clearRanges();const t=this.nativeSelection.rangeCount;for(let e=0;e<t;e++){const t=this.amendRange(this.nativeSelection.getRangeAt(e));if(!t)return;this.addRange(this.createRangeFromNativeRange(t))}}_extendRangesFromNative(){const t=this.nativeSelection.rangeCount;if(t>0){const e=this.amendRange(this.nativeSelection.getRangeAt(t-1));if(!e)return;let n=!1;if(this.ranges.forEach((t=>{t.endContainer===e.endContainer&&t.startOffset===e.startOffset&&(n=!0,t.remove())})),n)return;this.addRange(this.createRangeFromNativeRange(e))}}getRangeAt(t=0){return this.ranges[t]}removeAllRanges(){this.nativeSelection.removeAllRanges(),this.clearRanges()}createNativeRange({startContainer:t,startOffset:e,endContainer:n,endOffset:o}){const r=document.createRange();return r.setStart(t,e),r.setEnd(n,o),r}updatePoints(t,e,n,o){this.rangePoints.forEach((r=>{r.container===t&&e<=r.offset&&(r.range[r.pointName+"Offset"]+=n,o&&(r.range[r.pointName+"Container"]=o))}))}updateRangesFromNative(t){setTimeout((()=>{t?this._extendRangesFromNative():this._resetRangesFromNative(),this.updateCaret()}))}updateCaret(t=!0){this.ranges.forEach((e=>e.updateCaret(t))),this.rangeCount>1&&this._distinct(),t&&this.drawRangeBg()}_isCoverd(t,e){return t.y<e.y?t.y+t.height>=e.y+e.height:e.y+e.height>=t.y+t.height}_distinct(){let t={},e=this.ranges.length;if(!(e<2)){for(let n=0;n<e;n++){const o=this.ranges[n],r=`${this.editor.queryPath(o.startContainer).position}-${o.caret.rect.x}-${o.caret.rect.y}`;if(t[r])o.caret.remove(),this.ranges.splice(n,1),e--,n--;else{const i=Object.entries(t).filter((t=>o.caret.rect.x===t[1].caret.rect.x));0===i.length?t[r]=o:this._isCoverd(o.caret.rect,i[0][1].caret.rect)?(o.caret.remove(),this.ranges.splice(n,1),e--,n--):t[r]=o}}t=null}}drawRangeBg(t){const e=t||this.getRangeAt(0);if(!e)return;const{startContainer:n,startOffset:o,endContainer:r,endOffset:i}=e;this.nativeSelection.removeAllRanges();const s={startContainer:n.elm,endContainer:r.elm,startOffset:o,endOffset:i};this.nativeSelection.addRange(this.createNativeRange(s))}getSeletedPath(){if(this.collapsed)return[];const t=this.ranges[0];let e,n,o,r=!1;if(t.collapsed)r=!0;else{if(0===t.startOffset)e=t.startContainer;else if(t.startOffset===t.startContainer.length)e=t.startContainer.nextLeaf;else{const n=t.startContainer.split(t.startOffset);this.updatePoints(t.startContainer,t.startOffset,-t.startOffset,n[1]),e=n[1]}if(0===t.endOffset)n=t.endContainer.prevLeaf;else if(t.endOffset===t.endContainer.length)n=t.endContainer;else{const e=t.endContainer.split(t.endOffset);this.updatePoints(t.endContainer,t.endOffset+1,-t.endOffset,e[1]),n=e[0]}}return o=e,{length:0,next:function(){if(r)return{value:void 0,done:r};{const t={value:o,done:r};return r=o===n,o=o.nextLeaf,this.length++,t}},[Symbol.iterator]:function(){return this}}}recoverRangesFromSnapshot(t){this.removeAllRanges(),this.ranges=t.map((t=>this.createRange({startContainer:this.editor.queryPath(t.startContainer),endContainer:this.editor.queryPath(t.endContainer),startOffset:t.startOffset,endOffset:t.endOffset,d:t.d}))),this.updateCaret()}}class Lt{steps=[];startRanges=[];endRanges=[];commited=!1;constructor(t){this.editor=t,this.init()}init(){this.startRanges=this.editor.selection.rangesSnapshot}addAndApplyStep(t){return this.steps.push(t),t.apply(this.editor)}addStep(...t){this.steps.push(...t)}commit(){if(0===this.steps.length)return this;this.endRanges=this.editor.selection.rangesSnapshot,this.editor.history.push(this),this.commited=!0}apply(){for(let t=0;t<this.steps.length;t++)this.steps[t].apply(this.editor);setTimeout((()=>{this.editor.selection.recoverRangesFromSnapshot(this.endRanges)}))}rollback(){for(let t=this.steps.length;t>0;t--)this.steps[t-1].invert(this.editor);setTimeout((()=>{this.editor.selection.recoverRangesFromSnapshot(this.startRanges)}))}}const Mt={createPath:D,queryPath:j,Formater:tt,Content:class extends gt{uuid=T();get renderContent(){return this.$editor.formater.render(this.$path)}get displayType(){return"inline"}constructor(t){super(t)}get contentLength(){return this.$path.length}get $path(){return this.props.path}get $editor(){return this.props.editor}shouldComponentUpdate(){return 1!==this.$path.rebuildFlag}onBeforeRender(){this.$path._$component=this}update(t,e){return this.onBeforeUpdate&&this.onBeforeUpdate({path:t||this.$path,range:e}),this.setState().then((()=>{this.$editor.selection.drawRangeBg(),this.onAfterUpdate&&this.onAfterUpdate({range:e,path:t})}))}onInsert({data:t,type:e,range:n}){if("text"===e){const e=new Et({range:n,data:t});return e.apply(),this.update().then((()=>{n.collapse(!1),n.updateCaret()})),e}}onContentDelete({range:t,ts:e}){console.log("删除",e);const{endContainer:n,endOffset:o,startContainer:r,startOffset:i,collapsed:s}=t,a=r.queryCommonPath(n);if(s){const i=r.prevLeaf;if(o>0){const s=new Ot({range:t,count:1});e.addAndApplyStep(s),0===r.block.contentLength?(t.setStart(r,0).collapse(),r.block.$path.parent.component.update()):0===r.length?(r.delete(),i.block===r.block&&i?t.setStart(i,i.length).collapse():t.setStart(r.nextLeaf,0).collapse()):(this._updatePoints(n,o,-1),i?.block===r.block&&1===o&&t.setStart(i,i.length).collapse())}else if(0===r.block.contentLength)r.block.$path.delete(),t.setStart(i,i.length).collapse();else if(0===r.length)r.delete();else if(r.block!==i.block){const e=r.parent;0===i.length?(i.parent.pop(),i.parent.push(...r.parent.children),e.delete(),t.setStart(r,0)):(i.parent.splice(i.index+1,0,...r.parent.children),e.delete(),t.setStart(r,0).collapse())}else t.setStart(i,i.length).collapse(),this.onContentDelete(t)}else r===n?(r.textDelete(o,o-i),0===r.length&&(r.delete(),t.setStart(r.prevLeaf,r.prevLeaf.length).collapse()),t.collapse(!0)):(r.textDelete(r.length,r.length-i),n.textDelete(o,o),a.deleteBetween(r,n),r.block!==n.block&&(n.parent.delete(),r.parent.splice(r.index+1,0,...n.parent.children.filter((t=>t.length)))),t.collapse(!0),console.log(t.startOffset,t.endOffset,t));a.component.update(a,t).then((()=>{t.updateCaret()}))}enterPath(t,e){let n=null;if("left"===e){const e=t.endContainer;if(n=e.nextLeaf,!n)return null;const o=e.block===n.block;t.set(n,o?1:0)}else{if(n=t.startContainer.prevLeaf,!n)return null;t.set(n,n.length)}return{path:n,range:t}}leavePath(t,e){if("left"===e){const e=t.startContainer;let n=e.prevLeaf;return n&&e?(t.set(e,e.length),n.component.enterPath(t,"right")):null}{let e=t.endContainer.nextLeaf;return e?e.component.enterPath(t,"left"):null}}onCaretMove(t,e,n){const o=e.container,{shiftKey:r}=n;let i={path:o,range:e};return 0===e.d&&(e.d="left"===t?-1:1),this.isCaretShouldLeavePath(o,e,t)?i=this.leavePath(e,t):"left"===t?e.offset>0&&(e.offset-=1):e.offset<o.length&&(e.offset+=1),r||e.collapse("left"===t),i}onLinefeed(t,e){if(console.log(1),e.inputState.isComposing)return;let n;if(t?.preventDefault?.(),e.collapsed||Ct({range:e}),e.container.length){n=e.container.parent.clone();let t=[];if(t=0===e.offset?[e.container.prevSibling||null,e.container]:e.offset===e.container.length?[e.container,e.container.nextSibling||null]:e.container.split(e.offset),null===t[0]){const t=D({data:""});n.insertBefore(e.container.parent),n.push(t)}else if(null===t[1]){const t=D({data:""});n.insertAfter(e.container.parent),n.push(t),e.set(n.children[0],0)}else n.insertAfter(e.container.parent),e.container.parent.children.slice(t[1].index).forEach((t=>{t.moveTo(n)})),e.set(n.children[0],0)}else n=e.container.parent.clone(!0),n.insertAfter(e.container.parent),e.set(n.children[0],0);n.parent.component.update().then((()=>{e.collapse(!0),e.updateCaret()}))}onKeydownArrowLeft({event:t,range:e}){yt("left",e,t),this.$editor.selection.updateCaret()}onKeydownArrowRight({event:t,range:e}){yt("right",e,t),this.$editor.selection.updateCaret()}onKeydownArrowUp({event:t,range:e}){vt("up",e,t),this.$editor.selection.updateCaret()}onKeydownArrowDown({event:t,range:e}){vt("down",e,t),this.$editor.selection.updateCaret()}onKeydownBackspace({event:t,range:e,ts:n}){Ct({event:t,range:e,ts:n})}onKeydownEnter({event:t,range:e}){this.onLinefeed(t,e)}isCaretShouldLeavePath(t,e,n){if("left"===n&&e.offset<=1){let n=t.prevLeaf;return!!n&&(0===e.offset||t.block===n.block)}return"right"===n&&e.offset===t.length}_updatePoints(t,e,n,o){this.$editor.selection.updatePoints(t,e,n,o)}setFormat(t,e){const n=t.startContainer.queryCommonPath(t.endContainer),o=this.$editor.selection.getSeletedPath();for(const t of o)e(t);n.component.update().then((()=>{t.updateCaret(),this.$editor.selection.drawRangeBg()}))}},Path:I,Selection:At,createRef:function(){return{current:null}},createVnode:W,patch:ht,Component:gt,utils:t,setVdomOrElm:m,setVnodeOrIns:g,setVdomOrPath:y,getVdomOrElm:f,getVdomOrPath:p,getVnodeOrIns:u,setVdomOrIns:v,getVdomOrIns:h,SplitText:kt,vnodeType:o};window.setFormat=function(t,e){const n=new Lt(t);t.selection.ranges.forEach((t=>{const o=t.startContainer.queryCommonPath(t.endContainer),r=function(t,e,n){if(t.collapsed)return[];let o,r,i,s=!1;if(t.collapsed)s=!0;else{if(0===t.startOffset)o=t.startContainer;else if(t.startOffset===t.startContainer.length)o=t.startContainer.nextLeaf;else{const e=new kt(t.startContainer,t.startOffset);o=n.addAndApplyStep(e)[1]}if(0===t.endOffset)r=t.endContainer.prevLeaf;else if(t.endOffset===t.endContainer.length)r=t.endContainer;else{const e=new kt(t.endContainer,t.endOffset),o=n.addAndApplyStep(e);r=o[0]}}return i=o,{length:0,next:function(){if(s)return{value:void 0,done:s};{const t={value:i,done:s};return s=i===r,i=i.nextLeaf,this.length++,t}},[Symbol.iterator]:function(){return this}}}(t,0,n);for(const t of r){const o=new St(t,0,e);n.addAndApplyStep(o)}n.commit(o),o.component.update()}))},window.deleteText=function(t,e){const n=new Lt(t);t.selection.ranges.forEach((t=>{const o=new Ot(t.container,t.offset,e);n.addAndApplyStep(o),n.commit(t.container.parent),t.container.parent.component.update()}))};const Tt={},Pt=Tt;class Bt{size=50;queue=[];idx=-1;editor=null;constructor({size:t,editor:e}){this.size=t||50,this.editor=e}get current(){return this.queue[this.idx]}push(t){this.current!==t&&(this.queue.length===this.size?this.queue.shift():this.idx++,this.queue.splice(this.idx,this.size,t))}redo(){return this.idx!==this.queue.length-1&&(this.idx++,this.current.apply())}undo(){if(-1===this.idx)return!1;{const t=this.current.rollback();return this.idx--,t}}}const $t={value:"",isComposing:!1};function _t(t){return t.replace(/( |^)[a-z]/g,(t=>t.toUpperCase()))}const zt=["mount"];class Nt{contentRef={current:null};renderContent(){return(0,arguments[arguments.length-1])("div",{id:"editor-content",style:"position:relative",ref:this.contentRef},[this.renderPath()])}constructor(t){z(new.target,Nt,zt),this.$path=t.path,t.path._editor=this,function({editor:t,formats:e,plugins:n}){!function(t,e){const n=new tt;var o;n.register(e),t.$eventBus={all:o=o||new Map,on:function(t,e){var n=o.get(t);n?n.push(e):o.set(t,[e])},off:function(t,e){var n=o.get(t);n&&(e?n.splice(n.indexOf(e)>>>0,1):o.set(t,[]))},emit:function(t,e){var n=o.get(t);n&&n.slice().map((function(t){t(e)})),(n=o.get("*"))&&n.slice().map((function(n){n(t,e)}))}},n.inject("editor",t),t.formater=n}(t,e),function(t){t.history=new Bt({editor:t})}(t),(t=>{for(let e=0;e<t.length;e++)t[e].install(Tt,Mt)})(n),function(t){t.selection=new At(t)}(t),function(t){Promise.resolve().then((()=>{Pt.platform.initIntercept(t)}))}(t),function(t){let e,n=null;t.on("mouseEvents",(e=>{if(!e.shiftKey&&0===e.button){const n=Pt.platform.nativeSelection.rangeCount;for(let t=0;t<n;t++)Pt.platform.nativeSelection.getRangeAt(t).collapse(!0);t.selection.updateRangesFromNative(e.altKey)}})),t.on("keyboardEvents",(o=>{if(n?n.commited||n.init():n=new Lt(t),function(t){return t.type.startsWith("composition")||"input"===t.type}(o)){if(console.log(o.type,o.key),null===o.data)return;!function(t,e){const{data:n,type:o}=t;if("input"===o){let t=" "===n?" ":n||"";if(!$t.isComposing&&n)e({data:t,type:"input"});else{const n=$t.value.length;$t.value=t,e({data:t,type:"compositioning",prevDataLength:n})}}else"compositionstart"===o?($t.value="",$t.isComposing=!0):"compositionend"===o&&(e({data:$t.value,type:"compositionend"}),t.target.value="",setTimeout((()=>{$t.value="",$t.isComposing=!1}),200))}(o,(({data:r,prevDataLength:i,type:s})=>{t.selection.ranges.forEach((a=>{a.collapsed||Ct({event:o,range:a,ts:n,force:!0}),i&&B(i,Ct,t,{event:o,range:a,ts:n,force:!0});const l=a.container;"input"!==s&&"compositioning"!==s||(e=l.component.onInsert({type:"text",data:r,range:a,ts:n,event:o}),n.addStep(e)),"input"!==s&&"compositionend"!==s||o.data||B(1,Ct,t,{event:o,range:a,ts:n,force:!0})}))}))}else{if($t.isComposing||"Process"===o.key)return;console.log(o.type,o.key);const e=o.key?`${o.type}${o.key}`:null,r=`${o.type}`;t.selection.ranges.forEach((t=>{const i=t.container,s=e?i.component[`on${_t(e)}`]:null,a=i.component[`on${_t(r)}`];"function"==typeof s&&s.call(i.component,{event:o,range:t,ts:n}),"function"==typeof a&&a.call(i.component,{event:o,range:t,ts:n})})),t.emit(e,o),t.emit(r,o)}n=n.commit()})),t.on("selectionchange-origin",(()=>{const e=Pt.platform.nativeSelection,{startContainer:n,startOffset:o,endContainer:r,endOffset:i}=t.selection.ranges[0]||{};t.emit("selectionchange",{startContainer:n,startOffset:o,endContainer:r,endOffset:i}),e&&!e.isCollapsed&&t.selection.ranges.forEach((t=>{t.caret.hidden()}))})),t.on("keydownz",(e=>{e.ctrlKey&&t.history.undo()})),t.on("keydownZ",(e=>{e.ctrlKey&&t.history.redo()}))}(t)}({editor:this,formats:t.formats,plugins:t.plugins})}renderPath(){return this.formater.render({children:[this.$path]})}on(t,e){this.$eventBus.on(t,e)}emit(t,e){this.$eventBus.emit(t,e)}focus(t){this.$eventBus.emit("focus",t)}destroy(){this.$eventBus.emit("destroy")}queryPath(t){return j(t,this.$path)}queryCommonPath(t,e){const n=this.queryPath(t),o=this.queryPath(e);return n.queryCommonPath(o)}}const Ht=Mt.createPath,Ft=Mt.Content,Vt=Mt.createRef,It=Mt.createVnode,Dt=Mt.patch,jt=Mt.Component,Ut=Mt.utils;n(424);var Kt=n(764),qt=n.n(Kt),Gt=n(520),Xt=n.n(Gt),Yt=n(668),Jt=n.n(Yt),Qt=n(252),Wt=n.n(Qt),Zt=n(456),te=n.n(Zt),ee=n(992),ne=n.n(ee),oe=n(592),re={};re.styleTagTransform=ne(),re.setAttributes=Wt(),re.insert=Jt().bind(null,"head"),re.domAPI=Xt(),re.insertStyleElement=te(),qt()(oe.c,re),oe.c&&oe.c.locals&&oe.c.locals;class ie extends jt{constructor(t){super(t),this.state={visiable:!1},this.dialogRef=Vt()}render(){const t=arguments[arguments.length-1];return t("div",{ref:this.dialogRef},[this.state.visiable?t("div",{style:"background:#ddd;position:absolute;top:35px;z-index:1"},[this.props.children.length?this.props.children:"dialog"]):""])}outClickHandle=t=>{this.props.barItemRef.current.contains(t.target)||(this.setState({visiable:!1}),document.removeEventListener("click",this.outClickHandle))};toggle(){this.state.visiable||document.addEventListener("click",this.outClickHandle),this.setState({visiable:!this.state.visiable})}}class se extends jt{render(){const t=arguments[arguments.length-1];return t("div",{class:"editor-tooltip"},[this.props.children.length?this.props.children:"",t("span",{class:"tooltiptext top",style:`width:${this.props.width}px;margin-left:-${this.props.width/2}px;`},[this.props.content||"content"])])}}function ae(t,e,n){n/=100;const o=e=>(e+t/30)%12,r=(e/=100)*Math.min(n,1-n),i=t=>n-r*Math.max(-1,Math.min(o(t)-3,Math.min(9-o(t),1)));return[255*i(0),255*i(8),255*i(4)].map((t=>le(t)))}function le(t,e=0){return t}function ce(t,e,n){t/=255,e/=255,n/=255;const o=Math.max(t,e,n),r=o-Math.min(t,e,n),i=r?o===t?(e-n)/r:o===e?2+(n-t)/r:4+(t-e)/r:0;return[60*i<0?60*i+360:60*i,100*(r?o<=.5?r/(2*o-r):r/(2-(2*o-r)):0),100*(2*o-r)/2].map((t=>le(t)))}function de(t,e,n){e=e<0?0:e>1?1:e,n=n<0?0:n>1?1:n;const[o,r,i]=ae(t,100,50),s=((255-r)*e+r)*n,a=((255-i)*e+i)*n;return[le(((255-o)*e+o)*n),le(s),le(a)]}function he(t){const[e,n,o]=t;return`#${(e<<16|n<<8|o).toString(16).padStart(6,"0")}`}const{throttle:pe,isDef:ue}=Ut;function fe(t){return t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,t.returnValue=!1,!1}class me extends jt{constructor(t){super(t),this.state={H:0,x:228,y:0,px:0,py:1},this.containerRef=Vt()}render(){const t=arguments[arguments.length-1];return t("div",{style:`background: linear-gradient(to top, rgba(0, 0, 0, 1), transparent), linear-gradient(to left, hsla(${this.state.H}, 100%, 50%, 1), rgba(255, 255, 255, 1))`,onMousedown:this.handleMouseDown,class:"palette",ref:this.containerRef},[t("span",{style:`top:${this.state.y}px;left:${this.state.x}px;`,class:"cursor"},[])])}handleChange=pe((t=>{fe(t);const e="number"==typeof t.pageX?t.pageX:t.touches[0].pageX,n="number"==typeof t.pageY?t.pageY:t.touches[0].pageY;let o=e-(this.containerRef.current.getBoundingClientRect().left+window.scrollX),r=n-(this.containerRef.current.getBoundingClientRect().top+window.scrollY);o=o<0?0:o>228?228:o,r=r<0?0:r>150?150:r;const i=(228-o)/228,s=(150-r)/150,[a,l,c]=de(this.state.H,i,s);this.setState({x:o,y:r,px:i,py:s}),this.props.controlPanel.current.update(this.state.H,a,l,c)}),32);handleMouseDown=t=>{fe(t),this.handleChange(t),window.addEventListener("mousemove",this.handleChange),window.addEventListener("mouseup",this.handleMouseUp)};handleMouseUp=t=>{fe(t),this.unbindEventListeners()};unbindEventListeners=()=>{window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)};update(t,e,n,o){const[r,i]=function(t,e,n,o){const r={R:e,G:n,B:o},[i,s,a]=ae(t,100,50);let l,c,d,h;return[i,s,a].forEach(((t,e)=>{255===t&&(c=["R","G","B"][e]),0===t&&(l=["R","G","B"][e])})),h=r[c]/255,d=0===r[l]?0:r[l]/h/255,[le(d,2),le(h,2)]}(t,e,n,o),s=228*(1-r),a=150*(1-i);this.setState({x:s,y:a,px:r,py:i,H:t})}}const{throttle:ge,isDef:ye}=Ut;function ve(t){return t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,t.returnValue=!1,!1}class be extends jt{constructor(t){super(t),this.colorBlockStyle=`background:${this.props.color};`,this.state={x:200,x2:200,H:0,R:255,G:0,B:0,A:1},this.colorBlock=Vt(),this.hueContainer=Vt(),this.transparencyContainer=Vt()}render(){const t=arguments[arguments.length-1];return t("div",{class:"control-panel"},[t("div",{class:"left"},[t("div",{ref:this.hueContainer,onMousedown:this.handleHueMouseDown,class:"hue-slider slider-bar"},[t("div",{style:`left:${this.state.x}px`,class:"cursor"},[])]),t("div",{onMousedown:this.handleTransparencyMouseDown,class:"transparency-slider slider-bar",style:"margin-top:4px"},[t("div",{class:"transparency-gradient",ref:this.transparencyContainer,style:`background: linear-gradient(to right, rgba(${this.state.R},${this.state.G},${this.state.B},0) 0%, rgba(${this.state.R},${this.state.G},${this.state.B},1)`},[t("div",{style:`left:${this.state.x2}px;`,class:"cursor"},[])])])]),t("div",{class:"right"},[t("div",{class:"color-block-bg"},[]),t("div",{style:this.colorBlockStyle,ref:this.colorBlock,class:"color-block"},[])])])}onMounted(){console.log("onMountedonMounted"),this.$nextTick((()=>{let[t,e,n,o]=getComputedStyle(this.colorBlock.current).backgroundColor.match(/[\d||\.]+/g).map(Number);const[r]=ce(t,e,n);this.update(r,t,e,n,o),this.props.paletteRef.current.update(r,t,e,n)}))}update=(t,e,n,o,r)=>{r=ye(r)?r:this.state.A,this.updateColorBlockStyle(e,n,o,r);const i=194-5*t/9;this.setState({x:i,x2:194*r,H:t,R:e,G:n,B:o,A:r})};updateColorBlockStyle=(t,e,n,o)=>{this.colorBlockStyle=`background:rgba(${t},${e},${n},${o});`,this.props.onChange(t,e,n,o)};handleHueChange=ge((t=>{ve(t);let e=("number"==typeof t.pageX?t.pageX:t.touches[0].pageX)-(this.hueContainer.current.getBoundingClientRect().left+window.scrollX);e=e>=194?194:e<=0?0:e;const n=360*(1-e/194),[o,r,i]=de(n,this.props.paletteRef.current.state.px,this.props.paletteRef.current.state.py),s=this.state.A;this.update(n,o,r,i,s),this.props.paletteRef.current.update(n,o,r,i,s)}),32);handleTransparencyChange=ge((t=>{ve(t);let e=("number"==typeof t.pageX?t.pageX:t.touches[0].pageX)-(this.transparencyContainer.current.getBoundingClientRect().left+window.scrollX);e=e>=200?200:e<=0?0:e;const n=e/200,{R:o,G:r,B:i,H:s}=this.state;this.update(s,o,r,i,n)}),32);handleHueMouseDown=t=>{ve(t),this.handleHueChange(t),window.addEventListener("mousemove",this.handleHueChange),window.addEventListener("mouseup",this.handleMouseUp)};handleTransparencyMouseDown=t=>{ve(t),this.handleTransparencyChange(t),window.addEventListener("mousemove",this.handleTransparencyChange),window.addEventListener("mouseup",this.handleMouseUp)};handleMouseUp=t=>{ve(t),this.unbindEventListeners()};unbindEventListeners(){window.removeEventListener("mousemove",this.handleHueChange),window.removeEventListener("mousemove",this.handleTransparencyChange),window.removeEventListener("mouseup",this.handleMouseUp)}}const xe=[["#ffffff","#cccccc","#999999","#666666","#333333","#000000","#ff0000","#ff4500","#ffa500","#ffff00"],["#00ff00","#00ffff","#0000ff","#ff00ff","#800080","#8a2be2","#ff1493","#ff69b4","#ffc0cb","#ffd700"]];class Ce extends jt{state={hexColor:"",R:0,G:0,B:0,A:0};constructor(t){super(t),this.paletteRef=Vt(),this.controlPanelRef=Vt()}render(){const t=arguments[arguments.length-1];return t("div",{class:"color-picker-container"},[t("div",{class:"colors-block"},[xe.map((e=>t("div",{style:"display:flex;flex-wrap: wrap;justify-content:space-between;box-sizing:border-box;margin:4px 0"},[e.map((e=>{const n=this.isSelected(e);return t("div",{onClick:()=>this.colorsClick(e),style:`position: relative;${n?"width: 16px; height: 16px;padding:1px":"width: 18px; height: 18px"}; margin: 1px;`},[t("div",{style:`background:${e}; width: 100%; height: 100%; border-radius: 20%;`},[]),n?t("div",{style:"position: absolute; inset: -2px; border: 1px solid orange; border-radius: 20%; pointer-events: none;"},[]):""])}))])))]),t("div",{class:"divider divider-height-1 divider-dashed divider-color-gray"},[]),t("div",{class:"picker-block",style:"font-size:0;"},[t(me,{ref:this.paletteRef,controlPanel:this.controlPanelRef},[]),t(be,{onChange:this.onChange,ref:this.controlPanelRef,color:this.props.color,paletteRef:this.paletteRef},[])]),t("div",{onClick:this.submit,class:"btn submit"},["确定"])])}colorsClick=t=>{this.setState({hexColor:t});const[e,n,o,r]=function(t){t=t.replace(/^#/,"");const e=parseInt(t,16);return[e>>16&255,e>>8&255,255&e,1]}(t),[i]=ce(e,n,o);this.update(i,e,n,o,r)};update=(t,e,n,o,r)=>{this.controlPanelRef.current.update(t,e,n,o,r),this.paletteRef.current.update(t,e,n,o)};isSelected=t=>this.state.hexColor===t;onChange=(t,e,n,o)=>{this.setState({hexColor:he([t,e,n]),R:t,G:e,B:n,A:o})};submit=()=>{const{R:t,G:e,B:n,A:o}=this.state;this.props.onOk({R:t,G:e,B:n,A:o})};onMounted(){console.log("ColorPicker")}onCreated(){console.log("-=onCreated=-")}}const we=[[1,"H1"],[2,"H2"],[3,"H3"],[4,"H4"],[5,"H5"],[6,"H6"]],ke={fontColor:(t,e)=>t("div",{id:"colorPicker"},[t(Ce,{onOk:e.props.onOk,color:"#666666"},[])]),header:(t,e)=>t("div",{onClick:t=>function(t,e){const n=t.target.dataset.headervalue;n&&e.props.onOk(n)}(t,e),style:"color:#666"},[we.map((e=>t("div",{"data-headervalue":e[0]},[e[1]])))])};class Se extends jt{constructor(t){super(t)}render(t){return ke[this.props.name]?.(t,this)||t("span",{},["404"])}}class Oe extends jt{toolBarItemInses=[];constructor(t){super(t),this.props.editor.on("selectionchange",(t=>{const{startContainer:e,endContainer:n}=t,o=[];let r=e;for(;o.push(r),r!==n;)r=r.nextLeaf;const i=function(t){if(0===t.length)return{};const e={};for(const n in t[0]){const o=t[0][n];t.every((t=>t[n]===o))&&(e[n]=o)}return e}(o.map((t=>t.node.formats)));this.notice(i)}))}notice(t){this.toolBarItemInses.forEach((e=>e.onNotice(t)))}render(){const t=arguments[arguments.length-1],{tools:e}=this.props;return t("div",{class:"editor-tool-bar"},[e.map((e=>t(se,{width:"64",content:e.tooltip},[t(Ee,{...{...e,onCommand:this.onCommand,toolBarItemInses:this.toolBarItemInses}},[])])))])}onCommand=(t,...e)=>{this.props.onCommand(t,...e)}}class Ee extends jt{constructor(t){super(t),this.state={active:!1},this.props.toolBarItemInses.push(this),this.dialogRef=Vt(),this.barItemRef=Vt()}onNotice(t){t[this.props.name]!==this.state.active&&this.setState({active:t[this.props.name]})}render(){const t=arguments[arguments.length-1];return t("span",{class:"editor-tool-bar-item",ref:this.barItemRef,style:`color: ${this.state.active?"rgb(42 201 249)":"rgb(227 227 227);"};`},[t("svg",{onClick:this.clickHandle,class:"icon","aria-hidden":!0,ns:"http://www.w3.org/2000/svg"},[t("use",{"xlink:href":this.props.icon},[])]),this.props.showDialog?t(ie,{ref:this.dialogRef,barItemRef:this.barItemRef},[t(Se,{onOk:this.onOk,name:this.props.name},[])]):""])}onOk=t=>{this.dialogRef.current.toggle(),this.emitComand(t)};emitComand=t=>{this.props.editor.command(this.props.name,t)};clickHandle=()=>{this.dialogRef.current?this.dialogRef.current.toggle():this.emitComand()}}function Re(t){return document.getElementById(t).appendChild(Dt(function(t){const e=arguments[arguments.length-1];return e("div",{class:"editor-wrappe"},[e(Oe,{tools:[...t.toolBarOptions],editor:t},[]),t.renderContent(e)])}(this,It))),this}function Ae(t,e){return t.replace(/(\d*).*/,(function(t,n){return n*e}))}let Le;Le=Range.prototype.getClientRects?t=>{const e=document.createRange();let n;3!==t.container.elm.nodeType?0===t.offset?(e.setStart(t.container.elm,t.offset),e.setEnd(t.container.elm,t.offset+1),n=e.getClientRects()[0]):(e.setStart(t.container.elm,t.offset-1),e.setEnd(t.container.elm,t.offset),n=e.getClientRects()[0],n.x+=n.width):(e.setStart(t.container.elm,t.offset),n=e.getClientRects()[0]),e.setStart(t.container.elm,t.offset);const o=Be(t.editor.contentRef.current),r=Pe(t.editor.contentRef.current);return{x:n.x+o.x-r.x,y:n.y+o.y-r.y,height:n.height}}:t=>(new Te).measure(t.container.elm,t.offset);class Me{dom=null;rect=null;defaultStyle={};style={};constructor(t){this.range=t,this.dom=document.createElement("span"),this.dom.classList.add("custom-caret"),this.setStyle(this.dom)}setStyle(t={}){Object.assign(this.style,this.defaultStyle,t)}remove(){this.dom.remove()}hidden(){"none"!==this.style.display&&(this.setStyle({display:"none"}),this.draw())}show(){"inline-block"!==this.style.display&&(this.setStyle({display:"inline-block"}),this.draw())}update(t=!0){if(this.rect=Le(this.range),!t)return;this.range.editor.contentRef.current.appendChild(this.dom);let e=this.range.startContainer.elm;if(!e)return;e instanceof Element||(e=e.parentNode);const n=getComputedStyle(e),o={top:this.rect.y+"px",left:this.rect.x-1+"px",height:this.rect.height+"px",fontSize:n.fontSize,background:n.color,display:this.range.collapsed?"inline-block":"none"};this.setStyle(o),this.draw()}draw(){((t,e)=>{for(const n in e)t.style[n]=e[n]})(this.dom,this.style)}}class Te{dom=null;instance=null;constructor(){if(Te.instance)return Te.instance;this.dom=document.createElement("text"),Te.instance=this}measure(t,e){let n;return 3===t.nodeType?e?(n=t.splitText(e),t.parentNode.insertBefore(this.dom,n)):t.parentNode.insertBefore(this.dom,t):t.childNodes[e-1]&&"BR"===t.childNodes[e-1].nodeName?t.insertBefore(this.dom,t.childNodes[e-1]):t.childNodes[e]?t.insertBefore(this.dom,t.childNodes[e]):t.appendChild(this.dom),this._getRect(t,e,n)}_getRect(t,e,n){let o=t;t instanceof Element||(o=t.parentNode);const r=Ae(getComputedStyle(o).fontSize,1.3)/1,i={x:this.dom.offsetLeft,y:this.dom.offsetTop,height:r||this.dom.offsetHeight};return this.dom.remove(),3===t.nodeType&&e&&(!t.data&&t.nextSibling?t.nextSibling.remove():(t.data+=n.data,n.remove())),i}}function Pe(t,e={x:0,y:0}){return e.height=e.height??t.offsetHeight,e.x+=t.offsetLeft,e.y+=t.offsetTop,t.offsetParent&&"HTML"!==t.offsetParent.tagName?Pe(t.offsetParent,e):e}function Be(t,e={x:0,y:0}){return e.x+=t.scrollLeft||0,e.y+=t.scrollTop||0,t.parentNode?Be(t.parentNode,e):e}const $e={};function _e(t,e,n){let o,r=n?.props,i=e.props;if((r||i)&&r!==i){for(o in r=r||{},i=i||{},i){if(/^on[A-Z]|class|style/.test(o))continue;const e=i[o];r[o]!==e&&(!0===e?t.setAttribute(o,""):!1===e?t.removeAttribute(o):120!==o.charCodeAt(0)?t.setAttribute(o,e):58===o.charCodeAt(3)?t.setAttributeNS("http://www.w3.org/XML/1998/namespace",o,e):58===o.charCodeAt(5)?t.setAttributeNS("http://www.w3.org/1999/xlink",o,e):t.setAttribute(o,e))}for(o in r)o in i||t.removeAttribute(o)}}const ze={create:_e,update:_e};function Ne(t,e,n){let o=new Map,r=new Map;e&&Object.keys(e.props).forEach((t=>{/^on[A-Z]/.test(t)&&r.set(t.replace(/^on/,"").toLowerCase(),e.props[t])})),n&&Object.keys(n.props).forEach((t=>{/^on[A-Z]/.test(t)&&o.set(t.replace(/^on/,"").toLowerCase(),e.props[t])})),(o.size||r.size)&&(r.forEach(((e,n)=>{o.has(n)||t.addEventListener(n,e,!1)})),o.forEach(((e,n)=>{r.has(n)||t.removeEventListener(n,e,!1)})))}const He={create:Ne,update:Ne};function Fe(t,e,n){const o=(e?.props.class||"").trim();let r,i;o&&t.setAttribute("class",o);const s=(n?.props.class||"").trim(),a=(e?.props.class||"").trim();(s||a)&&s!==a&&(r=new Set(s?s.split(/\s+/g):[]),i=new Set(a?a.split(/\s+/g):[]),i.forEach((e=>{r.has(e)||t.classList.add(e)})),r.forEach((e=>{i.has(e)||t.classList.remove(key)})))}const Ve={create:Fe,update:Fe},Ie={};function De(t,e,n){let o=n?.props.style,r=e?.props.style;(o||r)&&o!==r&&(o=o||Ie,r=r||Ie,Object.keys(o).forEach((e=>{r[e]||t.style.removeProperty(e.replace(/([A-Z])/g,"-$1").toLowerCase())})),Object.assign(t.style,r))}const je={create:De,update:De};function Ue(t,e){if(console.log(e),"function"==typeof t.tag)return;const n=$e.core.getVdomOrElm(t);"text"===t.tag?t.children!==e.children&&(n.data=t.children):(je.update(n,t,e),Ve.update(n,t,e),He.update(n,t,e),ze.update(n,t,e))}function Ke(t){const{createVnode:e,setVdomOrIns:n,setVnodeOrIns:o,setVdomOrElm:r,vnodeType:{VFUNCTION:i,VCOMPONENT:s,VTEXT:a}}=$e.core;let l;if(t.vnodeType===i){const o=t.tag(e,t.props);l=Ke(o),t.ref&&(t.ref.current=l),n(o,t),r(l,o),Ue(o)}else if(t.vnodeType===s){const i=new t.tag(t.props);t.ref&&(t.ref.current=i),"function"==typeof i.onCreated&&i.onCreated();const s=i._generateVdom_(e);l=Ke(s),n(s,i),o(i,t),r(l,s),Ue(s)}else{if(t.vnodeType===a)return l=document.createTextNode(t.children),r(l,t),l;l=t.ns?document.createElementNS(t.ns,t.tag):document.createElement(t.tag),t.ref&&(t.ref.current=l),r(l,t),Ue(t)}if(1===t.children?.length)l.appendChild(Ke(t.children[0]));else if(t.children?.length>1){const e=document.createDocumentFragment();for(let n=0;n<t.children.length;n++){const o=t.children[n];e.appendChild(Ke(o)),qe(o,"onMounted")}l.appendChild(e)}return l}function qe(t,e){if(t.vnodeType!==$e.core.vnodeType.VCOMPONENT)return;const n=$e.core.getVnodeOrIns(t);n&&"function"==typeof n[e]&&n[e]()}class Ge{input=null;constructor(t){this.editor=t,this._initIframe(),this._initInput(),this._initEvent()}_initIframe(){this.iframe=document.createElement("iframe"),this.iframe.classList.add("custom-input-iframe"),this.editor.contentRef.current.appendChild(this.iframe)}_initInput(){const t=this.iframe.contentDocument;this.input=t.createElement("input"),this.input.classList.add("custom-input"),t.body.appendChild(this.input)}focus(t){if(!(t=t||this.editor.selection.getRangeAt(0)))return;let e=t.startContainer.elm;e instanceof Element||(e=e.parentNode);const n=Ae(getComputedStyle(e).fontSize,1),o={position:"absolute",top:t.caret.rect.y+n/1+"px",left:t.caret.rect.x+"px"};!function(t,e){for(const n in e)t.style[n]=e[n]}(this.iframe,o),this.input.focus()}destroy(){this.input.removeEventListener("compositionstart",this._inputEvent.bind(this)),this.input.removeEventListener("compositionend",this._inputEvent.bind(this)),this.input.removeEventListener("input",this._inputEvent.bind(this)),this.iframe.contentDocument.removeEventListener("keydown",this._handGolobalKeydown.bind(this)),this.iframe.contentDocument.removeEventListener("keyup",this._handGolobalKeydown.bind(this))}_initEvent(){this.input.addEventListener("compositionstart",this._inputEvent.bind(this)),this.input.addEventListener("compositionend",this._inputEvent.bind(this)),this.input.addEventListener("input",this._inputEvent.bind(this)),this.iframe.contentDocument.addEventListener("keydown",this._handGolobalKeydown.bind(this)),this.iframe.contentDocument.addEventListener("keyup",this._handGolobalKeydown.bind(this))}_handGolobalKeydown(t){this.editor.emit("keyboardEvents",t)}_inputEvent(t){this.editor.emit("keyboardEvents",t)}}const Xe=document.getSelection();class Ye{selectionchangeHandle=function(t,e=0){let n;return function(...o){clearTimeout(n),n=setTimeout((()=>t.apply(this,o)),e)}}((()=>{const t=window.getSelection(),e=this.editor.contentRef.current;if(t.anchorNode&&t.focusNode){const n=t.anchorNode.parentElement,o=t.focusNode.parentElement;(n===e||o===e||e.contains(n)||e.contains(o))&&this.editor.emit("selectionchange-origin")}}),200);handMousedown(t){if(this.editor.emit("mouseEvents",t),!t.shiftKey&&0===t.button){const e=Xe.rangeCount;for(let t=0;t<e;t++)Xe.getRangeAt(t).collapse(!0);this.editor.selection.updateRangesFromNative(t.altKey)}}handMouseup(t){Xe.isCollapsed&&!t.shiftKey||this.editor.selection.updateRangesFromNative(t.altKey),this.editor.focus()}constructor(t){this.editor=t,this.addListeners()}destroy(){this.editor.contentRef.current.removeEventListener("mouseup",this.handMouseup.bind(this)),this.editor.contentRef.current.removeEventListener("mousedown",this.handMousedown.bind(this)),document.removeEventListener("selectionchange",this.selectionchangeHandle)}addListeners(){this.editor.contentRef.current.addEventListener("mouseup",this.handMouseup.bind(this)),this.editor.contentRef.current.addEventListener("mousedown",this.handMousedown.bind(this)),document.addEventListener("selectionchange",this.selectionchangeHandle)}}function Je(t){const e=new Ge(t),n=new Ye(t);t.on("focus",(t=>e.focus(t))),t.on("destroy",(()=>{e.destroy(),n.destroy()}))}const Qe=document,We=window,Ze=document.getSelection();function tn(t,e,n){return t.insertBefore(e,n)}function en(t,e,n){return t.replaceChild(e,n)}function nn(t,e){return t.appendChild(e)}function on(t,e){return t.removeChild(e)}function rn(t){const e=t.tagName.toLowerCase()||"text";if("text"===e)return $e.core.createVnode(e);const n={},o=[],r=t.attributes,i=t.childNodes;for(let t=0,e=r.length;t<e;t++){let e=r[t].nodeName;"style"===e&&isPrimitive(r[t].nodeValue)?n[e]=styleToObj(r[t].nodeValue):n[e]=r[t].nodeValue}for(let t=0,e=i.length;t<e;t++)o.push(rn(i[t]));return $e.core.createVnode(e,n,o)}const sn={...e};sn.install=(t,n)=>($e.core=n,t.platform=e,sn.initIntercept);const an=sn;class ln extends Ft{state={initProp:null};render(){const t=arguments[arguments.length-1];return t("div",{style:"display:inline-block"},["我是image的一部分",t("div",{onMousedown:this.onMousedown,onClick:this.sizeChange,style:"display:inline-block;height:15px;width:15px;background:red;user-select:none"},[]),t("img",{onMousedown:this.onMousedown,onClick:this.sizeChange,...this.$path.node.data},[])])}onMousedown=t=>{t.preventDefault(),t.stopPropagation()};sizeChange=t=>{this.state.initProp||(this.state.initProp={...this.$path.node.data}),this.$path.node.data.width===this.state.initProp.width?(this.$path.node.data.width="100px",this.$path.node.data.height="100px"):(this.$path.node.data.width=this.state.initProp.width,this.$path.node.data.height=this.state.initProp.height),this.update()};onAfterUpdate(){this.$editor.selection.updateCaret()}onContentDelete(t,e){const{endOffset:n,collapsed:o}=e;if(o)if(n>0){const n=this.$path.parent.component;t.delete(),n.update(),n.onCaretEnterPath(this.$path.parent,e,!1)}else{const n=this.getPrevLeafPath(t);n&&n.component.onCaretEnterPath(n,e,!1)}}onCaretEnterPath(t,e,n){return e.set(t,"left"===n?0:1),{path:t,range:e}}get contentLength(){return 1}}class cn extends Ft{get displayType(){return"block"}onKeydownb(t,e){t?.ctrlKey&&(t?.preventDefault?.(),this.setFormat(e,(t=>{t.node.formats.bold=!t.node.formats.bold})))}onKeydownd(t,e){t?.ctrlKey&&(t?.preventDefault?.(),this.setFormat(e,(t=>{t.node.formats.deleteline=!t.node.formats.deleteline})))}onKeydowns(t,e){t?.ctrlKey&&(t?.preventDefault?.(),this.setFormat(e,(e=>{t.shiftKey?e.node.formats.sub=!e.node.formats.sub:e.node.formats.sup=!e.node.formats.sup})))}onKeydownu(t,e){t?.ctrlKey&&(t?.preventDefault?.(),this.setFormat(e,(t=>{t.node.formats.underline=!t.node.formats.underline})))}}class dn extends cn{render(){const t=arguments[arguments.length-1];return t("div",{},[this.$path.children.length?this.$path.render():this.state.placeholder(t)])}}class hn extends cn{render(){return(0,arguments[arguments.length-1])("p",{},[this.$path.render()])}onMounted(){console.log("Paragraph  onMounted")}onCreated(){console.log("Paragraph  onCreated")}onUnmounted(){console.log("Paragraph onUnmounted")}}class pn extends cn{render(t){return t(`h${this.props.level}`,null,this.$path.render())}}class un extends cn{render(){return(0,arguments[arguments.length-1])("table",{border:"1",style:"border-collapse:collapse;width:600px"},[this.$path.render()])}}class fn extends cn{render(){return(0,arguments[arguments.length-1])("tr",{},[this.$path.render()])}}class mn extends cn{constructor(t){super(t),this.state._$root=Vt()}render(){return(0,arguments[arguments.length-1])("td",{ref:this.state._$root,style:"text-align:center;width:50%"},[this.$path.render()])}}const gn=[{name:"root",type:"component",render(t,e){return(0,arguments[arguments.length-1])(dn,{...e},[])}},{name:"bold",type:"tag",render(t){const e=(0,arguments[arguments.length-1])("strong",{},[]);return t&&t.children.push(e),e}},{name:"image",type:"component",render(t,e){const n=(0,arguments[arguments.length-1])(ln,{...e},[]);return t&&t.children.push(n),n}},{name:"underline",type:"tag",render(t){const e=(0,arguments[arguments.length-1])("u",{},[]);return t&&t.children.push(e),e}},{name:"fontSize",type:"attribute",render(t,e){if(!t)return(0,arguments[arguments.length-1])("span",{style:{fontSize:e}},[]);t.props.style||(t.props.style={}),t.props.style.fontSize=e}},{name:"color",type:"attribute",render(t,e){if(!t)return(0,arguments[arguments.length-1])("span",{style:{color:e}},[]);t.props.style||(t.props.style={}),t.props.style.color=e}},{name:"paragraph",type:"component",render(t,e){const n=(0,arguments[arguments.length-1])(hn,{...e,key:e.path._uuid},[]);return t&&t.children.push(n),n}},{name:"deleteline",type:"tag",render(t){const e=(0,arguments[arguments.length-1])("del",{},[]);return t&&t.children.push(e),e}},{name:"sup",type:"tag",render(t){const e=(0,arguments[arguments.length-1])("sup",{},[]);return t&&t.children.push(e),e}},{name:"sub",type:"tag",render(t){const e=(0,arguments[arguments.length-1])("sub",{},[]);return t&&t.children.push(e),e}},{name:"table",type:"component",render(t,e){const n=(0,arguments[arguments.length-1])(un,{...e},[]);return t&&t.children.push(n),n}},{name:"row",type:"component",render(t,e){const n=(0,arguments[arguments.length-1])(fn,{...e},[]);return t&&t.children.push(n),n}},{name:"col",type:"component",render(t,e){const n=(0,arguments[arguments.length-1])(mn,{...e},[]);return t&&t.children.push(n),n}},{name:"background",type:"attribute",render(t,e){if(!t)return(0,arguments[arguments.length-1])("span",{style:{background:e}},[]);t.props.style||(t.props.style={}),t.props.style.background=e}},{name:"header",type:"component",render(t,e,n){const o=arguments[arguments.length-1];console.log(t,e);const r=o(pn,{...e,level:n,key:e.path._uuid},[]);return t&&t.children.push(r),r}}],yn={data:[{data:[{data:"这是1121一个基于Typex编写的简单富文本编辑器demo",formats:{color:"#666",bold:!0,fontSize:"20px"}}],formats:{paragraph:!0}},{data:[{data:"这是一个基于Typex编写的简单富文本编辑器demo"}],formats:{header:4}},{data:[{data:"Typex",formats:{color:"#ff9999"}},{data:"是一款全新架构的编辑器内核，该内核不依赖contenteditable;自主实现了光标、模拟输入、模拟选区;数据驱动，组件化，插件化，支持多光标，跨平台的设计。优秀的格式排版系统避免了脏标签的产生（打开控制台你会发现它的标签非常简洁）。多光标：按住alt+左键；加粗/取消加粗：ctrl+b；删除线/取消删除线：ctrl+d；上标/取消上标：ctrl+s ....",formats:{color:"#999"}}],formats:{paragraph:!0}},{data:[{data:"红色删除线",formats:{deleteline:!0,color:"red"}},{data:"上标示例",formats:{sup:!0,color:"green",fontSize:"12px"}},{data:"绿色加粗下划线",formats:{underline:!0,color:"green",bold:!0}},{data:"下标示例",formats:{sub:!0,color:"red",fontSize:"12px"}},{data:"背景示例",formats:{sub:!0,color:"white",fontSize:"16px",background:"orange"}}],formats:{paragraph:!0}},{data:[{data:"带静态内容的行内图片示例",formats:{color:"#ff9999",fontSize:"24px"}},{data:{src:"https://img2.baidu.com/it/u=3979034437,2878656671&fm=253&fmt=auto&app=138&f=JPEG?w=500&h=333",alt:"test image",width:"60px",height:"60px"},formats:{image:!0}},{data:{src:"https://img2.baidu.com/it/u=3979034437,2878656671&fm=253&fmt=auto&app=138&f=JPEG?w=500&h=333",alt:"test image",width:"50px",height:"50px"},formats:{image:!0}}],formats:{paragraph:!0}},{data:[{data:"表格示例:",formats:{color:"#666",bold:!0}}],formats:{paragraph:!0}},{data:[{data:[{data:[{data:[{data:"表格内容1",formats:{color:"green"}}],formats:{paragraph:!0}},{data:[{data:"表格内容2",formats:{color:"red",fontSize:"12px"}}],formats:{paragraph:!0}}],formats:{col:!0}},{data:[{data:[{data:"表格内容2",formats:{color:"Orange",fontSize:"20px",background:"#ddd"}}],formats:{paragraph:!0}}],formats:{col:!0}}],formats:{row:!0}}],formats:{table:!0}}],formats:{root:!0}},vn=[{tooltip:"撤销",name:"undo",icon:"#icon-undo",commandHandle:t=>{t.history.undo()}},{tooltip:"重做",name:"redo",icon:"#icon-todo",commandHandle:t=>{t.history.redo()}},{tooltip:"标题",name:"header",icon:"#icon-header",showDialog:!0,commandHandle:t=>{t.$path.children[0].node.formats.header=2,t.$path.component.update().then((()=>{console.log(1122)}))}},{tooltip:"字体大小",name:"fontSize",icon:"#icon-font-size"},{tooltip:"字体颜色",name:"fontColor",icon:"#icon-color",showDialog:!0,commandHandle:(t,{R:e,G:n,B:o,A:r})=>bn(t,(t=>t.node.formats.color=`rgba(${e},${n},${o},${r})`))},{tooltip:"加粗",name:"bold",icon:"#icon-bold",commandHandle:t=>bn(t,(t=>t.node.formats.bold=!t.node.formats.bold))},{tooltip:"下划线",name:"underline",icon:"#icon-underline",commandHandle:t=>bn(t,(t=>t.node.formats.underline=!t.node.formats.underline))},{tooltip:"删除线",name:"deleteline",icon:"#icon-del",commandHandle:t=>bn(t,(t=>t.node.formats.deleteline=!t.node.formats.deleteline))},{tooltip:"背景填充",name:"background",icon:"#icon-fill"},{tooltip:"左对齐",name:"leftAligned",icon:"#icon-align-left"},{tooltip:"居中",name:"middleAligned",icon:"#icon-align-middle"},{tooltip:"右对齐",name:"rightAligned",icon:"#icon-align-right"},{tooltip:"超链接",name:"link",icon:"#icon-link"},{tooltip:"图片",name:"img",icon:"#icon-img"},{tooltip:"代码段",name:"code",icon:"#icon-code"},{tooltip:"markdown",name:"markdown",icon:"#icon-markdown"},{tooltip:"视频",name:"radio",icon:"#icon-radio"},{tooltip:"清除样式",name:"clearStyle",icon:"#icon-clear-style",commandHandle:t=>bn(t,(t=>t.node.formats={}))}];function bn(t,e){t.selection.ranges.forEach((n=>{t.$path.component.setFormat(n,e)}))}class xn extends Nt{conamndHandles={};toolBarOptions=vn;constructor(t){super({formats:gn,plugins:[an],...t}),this.on("command",this.command),this.setToolBar(vn)}mount(t){return Re.call(this,t),this}setToolBar(t){if(!vn||"array"!==Ut.toRawType(vn))throw new Error("setToolBar 必须提供一个数组类型的参数");return this.conamndHandles={},this.toolBarOptions=vn.filter((e=>t.includes(e.name))),this.toolBarOptions.forEach((t=>{t.editor=this,this.conamndHandles[t.name]=t.commandHandle})),this}command(t,e){const n=this.conamndHandles[t];"function"==typeof n&&n(this,e)}}var Cn=n(196),wn={};wn.styleTagTransform=ne(),wn.setAttributes=Wt(),wn.insert=Jt().bind(null,"head"),wn.domAPI=Xt(),wn.insertStyleElement=te(),qt()(Cn.c,wn),Cn.c&&Cn.c.locals&&Cn.c.locals;const kn=["undo","redo","header","fontSize","fontColor","bold","underline","deleteline","background"];setTimeout((()=>{window.editor=function(t={}){const e=Ht(yn);return new xn({path:e})}({data:"hello world"}).setToolBar(kn).mount("editor-root")}),0)})()})();